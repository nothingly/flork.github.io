

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.png">
  <link rel="icon" href="/img/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="B612ğŸš€">
  <meta name="keywords" content="">
  
    <meta name="description" content="1ã€NoSQL1.1ä¸ºä»€ä¹ˆè¦ç”¨Nosqlå…ˆæ¥ç‚¹é¸¡æ±¤ æˆ‘ä»¬ç°åœ¨å¤„äº2020å¹´ï¼Œå¤„äºå¤§æ•°æ®æ—¶ä»£ï¼›å¤§æ•°æ®ä¸€èˆ¬çš„æ•°æ®åº“æ— æ³•è¿›è¡Œåˆ†æå‡ºæ¥äº†ï¼é€¼ç€è‡ªå·±å­¦ä¹ ï¼åªæœ‰ä¸æ–­çš„å­¦ä¹ ï¼è¿™æ˜¯åœ¨è¿™ä¸ªç¤¾ä¼šæ¥ç”Ÿå­˜çš„å”¯ä¸€æ³•åˆ™ï¼å­¦ä¹ è¿˜æ˜¯ä¸ºäº†è‡ªå·±ï¼Œä¸ºäº†å®¶äººï¼ä¸ºäº†è®©è‡ªå·±è¿‡å¾—æ›´åŠ çš„ä½“é¢ï¼ï¼ˆ1ï¼‰å•æœºMySQLçš„å¹´ä»£ï¼ â€ƒâ€ƒ90å¹´ä»£ï¼Œä¸€ä¸ªåŸºæœ¬çš„ç½‘ç«™è®¿é—®é‡ä¸€èˆ¬ä¸ä¼šå¤ªå¤§ï¼Œå•ä¸ªæ•°æ®åº“å®Œå…¨è¶³å¤Ÿï¼â€ƒâ€ƒé‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„å»ä½¿ç”¨é™æ€ç½‘é¡µ Html ~ æœåŠ¡å™¨">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis">
<meta property="og:url" content="https://lfrok.top/2022/11/27/Java/Redis/index.html">
<meta property="og:site_name" content="Le Petit Prince">
<meta property="og:description" content="1ã€NoSQL1.1ä¸ºä»€ä¹ˆè¦ç”¨Nosqlå…ˆæ¥ç‚¹é¸¡æ±¤ æˆ‘ä»¬ç°åœ¨å¤„äº2020å¹´ï¼Œå¤„äºå¤§æ•°æ®æ—¶ä»£ï¼›å¤§æ•°æ®ä¸€èˆ¬çš„æ•°æ®åº“æ— æ³•è¿›è¡Œåˆ†æå‡ºæ¥äº†ï¼é€¼ç€è‡ªå·±å­¦ä¹ ï¼åªæœ‰ä¸æ–­çš„å­¦ä¹ ï¼è¿™æ˜¯åœ¨è¿™ä¸ªç¤¾ä¼šæ¥ç”Ÿå­˜çš„å”¯ä¸€æ³•åˆ™ï¼å­¦ä¹ è¿˜æ˜¯ä¸ºäº†è‡ªå·±ï¼Œä¸ºäº†å®¶äººï¼ä¸ºäº†è®©è‡ªå·±è¿‡å¾—æ›´åŠ çš„ä½“é¢ï¼ï¼ˆ1ï¼‰å•æœºMySQLçš„å¹´ä»£ï¼ â€ƒâ€ƒ90å¹´ä»£ï¼Œä¸€ä¸ªåŸºæœ¬çš„ç½‘ç«™è®¿é—®é‡ä¸€èˆ¬ä¸ä¼šå¤ªå¤§ï¼Œå•ä¸ªæ•°æ®åº“å®Œå…¨è¶³å¤Ÿï¼â€ƒâ€ƒé‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„å»ä½¿ç”¨é™æ€ç½‘é¡µ Html ~ æœåŠ¡å™¨">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-11-27T09:58:46.501Z">
<meta property="article:modified_time" content="2022-11-27T10:33:46.987Z">
<meta property="article:author" content="B612ğŸš€">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Redis - Le Petit Prince</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"lfrok.top","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>B-612</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/same/">
                <i class="iconfont icon-twitch-fill"></i>
                æˆ‘ä»¬
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://pprince.top/bgc/bgc-2.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Redis"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-11-27 17:58" pubdate>
          2022å¹´11æœˆ27æ—¥ ä¸‹åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          51k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          426 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Redis</h1>
            
            
              <div class="markdown-body">
                
                <p>1ã€NoSQL<br>1.1ä¸ºä»€ä¹ˆè¦ç”¨Nosql<br>å…ˆæ¥ç‚¹é¸¡æ±¤</p>
<p>æˆ‘ä»¬ç°åœ¨å¤„äº2020å¹´ï¼Œå¤„äºå¤§æ•°æ®æ—¶ä»£ï¼›<br>å¤§æ•°æ®ä¸€èˆ¬çš„æ•°æ®åº“æ— æ³•è¿›è¡Œåˆ†æå‡ºæ¥äº†ï¼<br>é€¼ç€è‡ªå·±å­¦ä¹ ï¼åªæœ‰ä¸æ–­çš„å­¦ä¹ ï¼è¿™æ˜¯åœ¨è¿™ä¸ªç¤¾ä¼šæ¥ç”Ÿå­˜çš„å”¯ä¸€æ³•åˆ™ï¼<br>å­¦ä¹ è¿˜æ˜¯ä¸ºäº†è‡ªå·±ï¼Œä¸ºäº†å®¶äººï¼ä¸ºäº†è®©è‡ªå·±è¿‡å¾—æ›´åŠ çš„ä½“é¢ï¼<br>ï¼ˆ1ï¼‰å•æœºMySQLçš„å¹´ä»£ï¼</p>
<p>â€ƒâ€ƒ90å¹´ä»£ï¼Œä¸€ä¸ªåŸºæœ¬çš„ç½‘ç«™è®¿é—®é‡ä¸€èˆ¬ä¸ä¼šå¤ªå¤§ï¼Œå•ä¸ªæ•°æ®åº“å®Œå…¨è¶³å¤Ÿï¼<br>â€ƒâ€ƒé‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„å»ä½¿ç”¨é™æ€ç½‘é¡µ Html ~ æœåŠ¡å™¨æ ¹æœ¬æ²¡æœ‰å¤ªå¤§çš„å‹åŠ›ï¼<br>â€ƒâ€ƒæ€è€ƒä¸€ä¸‹ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼šæ•´ä¸ªç½‘ç«™çš„ç“¶é¢ˆæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æ•°æ®é‡å¦‚æœå¤ªå¤§ã€ä¸€ä¸ªæœºå™¨æ”¾ä¸ä¸‹äº†ï¼<br>æ•°æ®çš„ç´¢å¼• ï¼ˆB+ Treeï¼‰ï¼Œä¸€ä¸ªæœºå™¨å†…å­˜ä¹Ÿæ”¾ä¸ä¸‹<br>è®¿é—®é‡ï¼ˆè¯»å†™æ··åˆï¼‰ï¼Œä¸€ä¸ªæœåŠ¡å™¨æ‰¿å—ä¸äº†~<br>åªè¦ä½ å¼€å§‹å‡ºç°ä»¥ä¸Šçš„ä¸‰ç§æƒ…å†µä¹‹ä¸€ï¼Œé‚£ä¹ˆä½ å°±å¿…é¡»è¦æ™‹çº§ï¼</p>
<p>ï¼ˆ2ï¼‰ã€Memcachedï¼ˆç¼“å­˜ï¼‰ + MySQL + å‚ç›´æ‹†åˆ† ï¼ˆè¯»å†™åˆ†ç¦»ï¼‰<br>â€ƒâ€ƒç½‘ç«™80%çš„æƒ…å†µéƒ½æ˜¯åœ¨è¯»ï¼Œæ¯æ¬¡éƒ½è¦å»æŸ¥è¯¢æ•°æ®åº“çš„è¯å°±ååˆ†çš„éº»çƒ¦ï¼æ‰€ä»¥è¯´æˆ‘ä»¬å¸Œæœ›å‡è½»æ•°æ®çš„å‹ åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼“å­˜æ¥ä¿è¯æ•ˆç‡ï¼</p>
<p>â€ƒâ€ƒå‘å±•è¿‡ç¨‹ï¼š ä¼˜åŒ–æ•°æ®ç»“æ„å’Œç´¢å¼•â€“&gt; æ–‡ä»¶ç¼“å­˜ï¼ˆIOï¼‰â€”&gt; Memcachedï¼ˆå½“æ—¶æœ€çƒ­é—¨çš„æŠ€æœ¯ï¼ï¼‰</p>
<p>1.2åˆ†åº“åˆ†è¡¨+æ°´å¹³æ‹†åˆ†<br>â€ƒâ€ƒæŠ€æœ¯å’Œä¸šåŠ¡åœ¨å‘å±•çš„åŒæ—¶ï¼Œå¯¹äººçš„è¦æ±‚ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼</p>
<p>â€ƒâ€ƒæœ¬è´¨ï¼šæ•°æ®åº“ï¼ˆè¯»ã€å†™ï¼‰</p>
<p>â€ƒâ€ƒæ—©äº›å¹´MyISAMï¼š è¡¨é”ï¼Œååˆ†å½±å“æ•ˆç‡ï¼é«˜å¹¶å‘ä¸‹å°±ä¼šå‡ºç°ä¸¥é‡çš„é”é—®é¢˜<br>è½¬æˆ˜Innodbï¼šè¡Œé”</p>
<p>â€ƒâ€ƒæ…¢æ…¢çš„å°±å¼€å§‹ä½¿ç”¨åˆ†åº“åˆ†è¡¨æ¥è§£å†³å†™çš„å‹åŠ›ï¼ MySQL åœ¨å“ªä¸ªå¹´ä»£æ¨å‡º äº†è¡¨åˆ†åŒºï¼è¿™ä¸ªå¹¶æ²¡æœ‰å¤šå°‘å…¬å¸ä½¿ç”¨ï¼</p>
<p>â€ƒâ€ƒMySQL çš„ é›†ç¾¤ï¼Œå¾ˆå¥½æ»¡è¶³é‚£ä¸ªå¹´ä»£çš„æ‰€æœ‰éœ€æ±‚ï¼</p>
<p>å¦‚ä»Šæœ€è¿‘çš„å¹´ä»£<br>â€ƒâ€ƒ2010â€“2020 åå¹´ä¹‹é—´ï¼Œä¸–ç•Œå·²ç»å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼›ï¼ˆå®šä½ï¼Œä¹Ÿæ˜¯ä¸€ç§æ•°æ®ï¼ŒéŸ³ä¹ï¼Œçƒ­æ¦œï¼ï¼‰<br>MySQL ç­‰å…³ç³»å‹æ•°æ®åº“å°±ä¸å¤Ÿç”¨äº†ï¼æ•°æ®é‡å¾ˆå¤šï¼Œå˜åŒ–å¾ˆå¿«~ï¼</p>
<p>â€ƒâ€ƒMySQL æœ‰çš„ä½¿ç”¨å®ƒæ¥å­˜å‚¨ä¸€äº›æ¯”è¾ƒå¤§çš„æ–‡ä»¶ï¼Œåšå®¢ï¼Œå›¾ç‰‡ï¼æ•°æ®åº“è¡¨å¾ˆå¤§ï¼Œæ•ˆç‡å°±ä½äº†ï¼å¦‚æœæœ‰ä¸€ç§æ•°æ®åº“æ¥ä¸“é—¨å¤„ç†è¿™ç§æ•°æ®,</p>
<p>â€ƒâ€ƒMySQLå‹åŠ›å°±å˜å¾—ååˆ†å°ï¼ˆç ”ç©¶å¦‚ä½•å¤„ç†è¿™äº›é—®é¢˜ï¼ï¼‰å¤§æ•°æ®çš„IOå‹åŠ›ä¸‹ï¼Œè¡¨å‡ ä¹æ²¡æ³•æ›´å¤§ï¼</p>
<p>ç›®å‰ä¸€ä¸ªåŸºæœ¬çš„äº’è”ç½‘é¡¹ç›®ï¼</p>
<p>ä¸ºä»€ä¹ˆè¦ç”¨NoSQLï¼<br>â€ƒâ€ƒç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œç¤¾äº¤ç½‘ç»œï¼Œåœ°ç†ä½ç½®ã€‚ç”¨æˆ·è‡ªå·±äº§ç”Ÿçš„æ•°æ®ï¼Œç”¨æˆ·æ—¥å¿—ç­‰ç­‰çˆ†å‘å¼å¢é•¿ã€‚</p>
<p>â€ƒâ€ƒè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨NoSQLæ•°æ®åº“çš„ï¼ŒNosql å¯ä»¥å¾ˆå¥½çš„å¤„ç†ä»¥ä¸Šçš„æƒ…å†µã€‚</p>
<p>1.3ä»€ä¹ˆæ˜¯NoSql<br>åªè¦å­¦ä¸æ­»ï¼Œå°±å¾€æ­»é‡Œå­¦ï¼</p>
<p>â€ƒâ€ƒNoSQL &#x3D; Not Only SQL ï¼ˆä¸ä»…ä»…æ˜¯SQLï¼‰<br>â€ƒâ€ƒå…³ç³»å‹æ•°æ®åº“ï¼šè¡¨æ ¼ ï¼Œè¡Œ ï¼Œåˆ—</p>
<p>â€ƒâ€ƒæ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“çš„ï¼Œéšç€web2.0äº’è”ç½‘çš„è¯ç”Ÿï¼ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¾ˆéš¾å¯¹ä»˜web2.0æ—¶ä»£ï¼å°¤å…¶æ˜¯è¶…å¤§è§„æ¨¡çš„é«˜å¹¶å‘çš„ç¤¾åŒºï¼ æš´éœ²å‡ºæ¥å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼ŒNoSQLåœ¨å½“ä»Šå¤§æ•°æ®ç¯å¢ƒä¸‹å‘å±•çš„ååˆ†è¿… é€Ÿï¼ŒRedisæ˜¯å‘å±•æœ€å¿«çš„ï¼Œè€Œä¸”æ˜¯æˆ‘ä»¬å½“ä¸‹å¿…é¡»è¦æŒæ¡çš„ä¸€ä¸ªæŠ€æœ¯ï¼</p>
<p>â€ƒâ€ƒå¾ˆå¤šçš„æ•°æ®ç±»å‹ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œç¤¾äº¤ç½‘ç»œï¼Œåœ°ç†ä½ç½®ã€‚è¿™äº›æ•°æ®ç±»å‹çš„å­˜å‚¨ä¸éœ€è¦ä¸€ä¸ªå›ºå®šçš„æ ¼å¼ï¼ ä¸éœ€è¦å¤šæœˆçš„æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•çš„ ï¼ Map ä½¿ç”¨é”®å€¼å¯¹æ¥æ§åˆ¶ï¼</p>
<p>NoSQL ç‰¹ç‚¹<br>â€ƒâ€ƒ1ã€æ–¹ä¾¿æ‰©å±•ï¼ˆæ•°æ®ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼Œå¾ˆå¥½æ‰©å±•ï¼ï¼‰<br>â€ƒâ€ƒ 2ã€å¤§æ•°æ®é‡é«˜æ€§èƒ½ï¼ˆRedis ä¸€ç§’å†™8ä¸‡æ¬¡ï¼Œè¯»å–11ä¸‡ï¼ŒNoSQLçš„ç¼“å­˜è®°å½•çº§ï¼Œæ˜¯ä¸€ç§ç»†ç²’åº¦çš„ç¼“å­˜ï¼Œæ€§èƒ½ä¼šæ¯”è¾ƒé«˜ï¼ï¼‰<br>â€ƒâ€ƒ 3ã€æ•°æ®ç±»å‹æ˜¯å¤šæ ·å‹çš„ï¼ï¼ˆä¸éœ€è¦äº‹å…ˆè®¾è®¡æ•°æ®åº“ï¼éšå–éšç”¨ï¼å¦‚æœæ˜¯æ•°æ®é‡ååˆ†å¤§çš„è¡¨ï¼Œå¾ˆå¤šäººå°±æ—  æ³•è®¾è®¡äº†ï¼ï¼‰<br>â€ƒâ€ƒ4ã€ä¼ ç»Ÿ RDBMS å’Œ NoSQL<br>ä¼ ç»Ÿçš„ RDBMS</p>
<ul>
<li>ç»“æ„åŒ–ç»„ç»‡</li>
<li>SQL</li>
<li>æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­</li>
<li>æ“ä½œï¼Œæ•°æ®å®šä¹‰è¯­è¨€</li>
<li>ä¸¥æ ¼çš„ä¸€è‡´æ€§</li>
<li>åŸºç¡€çš„äº‹åŠ¡<br>â€¦<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>NoSQL</li>
<li>ä¸ä»…ä»…æ˜¯æ•°æ®</li>
<li>æ²¡æœ‰å›ºå®šçš„æŠ½è±¡è¯­è¨€</li>
<li>é”®å€¼å¯¹å­˜å‚¨ï¼Œåˆ—å­˜å‚¨ï¼Œæ–‡æ¡£å­˜å‚¨ï¼Œå›¾å½¢æ•°æ®åº“</li>
<li>æœ€ç»ˆä¸€è‡´æ€§</li>
<li>CAP å®šç† å’ŒBASE ï¼ˆå¼‚åœ°å¤šæ´»ï¼ï¼‰</li>
<li>é«˜æ‰©å±•ï¼Œé«˜å¯ç”¨ï¼Œé«˜å¯æ‰©</li>
<li>â€¦<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>â€ƒâ€ƒçœŸæ­£åœ¨å…¬å¸ä¸­çš„å®è·µï¼šNoSQL + RDBMS ä¸€èµ·ä½¿ç”¨æ‰æ˜¯æœ€å¼ºçš„ï¼Œé˜¿é‡Œå·´å·´çš„æ¶æ„æ¼”è¿›ï¼ æŠ€æœ¯æ²¡æœ‰é«˜ä½ä¹‹åˆ†ï¼Œå°±çœ‹ä½ å¦‚ä½•å»ä½¿ç”¨ï¼ï¼ˆæå‡å†…åŠŸï¼Œæ€ç»´çš„æé«˜ï¼ï¼‰</li>
</ul>
<p>1.4é˜¿é‡Œå·´å·´æ¼”è¿›åˆ†æ<br>æ€è€ƒé—®é¢˜ï¼šè¿™ä¹ˆå¤šä¸œè¥¿éš¾é“éƒ½æ˜¯åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸­çš„å—?</p>
<p>æŠ€æœ¯æ€¥ä¸å¾—ï¼Œè¶Šæ˜¯æ…¢æ…¢å­¦ï¼Œæ‰èƒ½è¶Šæ‰å®ï¼<br>1<br>å¤§é‡å…¬å¸åšçš„éƒ½æ˜¯ç›¸åŒçš„ä¸šåŠ¡ï¼›ï¼ˆç«å“åè®®ï¼‰</p>
<p>éšç€è¿™æ ·çš„ç«äº‰ï¼Œä¸šåŠ¡æ˜¯è¶Šæ¥è¶Šå®Œå–„ï¼Œç„¶åå¯¹äºå¼€å‘è€…çš„è¦æ±‚ä¹Ÿæ˜¯è¶Šæ¥è¶Šé«˜ï¼</p>
<p>æ•æ·å¼€å‘ï¼Œæé™ç¼–ç¨‹</p>
<p>å¦‚æœä½ æœªæ¥ç›¸å½“ä¸€ä¸ªæ¶æ„å¸ˆï¼š æ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ ä¸€å±‚è§£å†³ä¸äº†çš„ï¼</p>
<p>1ã€å•†å“çš„åŸºæœ¬ä¿¡æ¯<br>åç§°<br>ä»·æ ¼<br>å•†å®¶ä¿¡æ¯ï¼š<br>å…³ç³»æ•°æ®åº“å¯ä»¥è§£å†³äº†ï¼ˆMySql Oracleï¼‰é˜¿é‡Œäº‘çš„è¿™ç¾¤ç–¯å­</p>
<p>2.å•†å“çš„æè¿°ã€è¯„è®ºï¼ˆæ–‡å­—æ¯”è¾ƒå¤šï¼‰<br>æ–‡æ¡£æ€§æ•°æ®åº“ä¸­ï¼Œ Redis ã€MongoDB</p>
<p>3.å›¾ç‰‡<br>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ fastdfs</p>
<p>4.å•†å“çš„å…³é”®å­—ï¼ˆæœç´¢ï¼‰<br>æœç´¢å¼•æ“ solr elasticsearch<br>æ‰€æœ‰ç‰›é€¼çš„äººéƒ½æœ‰ä¸€æ®µè‹¦é€¼çš„å²æœˆï¼ä½†æ˜¯ä½ åªè¦åƒSBä¸€æ ·çš„å»åšæŒï¼Œç»ˆå°†ç‰›é€¼ï¼</p>
<p>5.å•†å“çƒ­é—¨çš„æ³¢æ®µä¿¡æ¯<br>å†…å­˜æ•°æ®åº“<br>redis<br>6.å•†å“çš„äº¤æ˜“ï¼Œå¤–éƒ¨çš„æ”¯ä»˜æ¥å£<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>å¤§å‹äº’è”ç½‘åº”ç”¨é—®é¢˜ï¼š<br>â€ƒâ€ƒæ•°æ®ç±»å‹å¤ªå¤šäº†<br>â€ƒâ€ƒæ•°æ®æºç¹å¤šï¼Œç»å¸¸é‡æ„</p>
<p>2ã€NoSqlçš„å››å¤§åˆ†ç±»<br>KVé”®å€¼å¯¹ï¼š<br>â€ƒâ€ƒæ–°æµªï¼šRedis<br>â€ƒâ€ƒç¾å›¢ï¼šRedis+Tair<br>â€ƒâ€ƒé˜¿é‡Œã€ç™¾åº¦ï¼šRedis+Memecache</p>
<p>æ–‡æ¡£å‹æ•°æ®åº“(bsonæ ¼å¼å’Œjson ä¸€æ ·)ï¼š<br>â€ƒMongoDBï¼ˆä¸€èˆ¬å¿…é¡»è¦æŒæ¡ï¼‰<br>â€ƒMongoDBæ˜¯åŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ï¼ŒC++ç¼–å†™çš„ï¼Œä¸»è¦ç”¨æ¥å¤„ç†å¤§é‡çš„æ–‡æ¡£ï¼<br>â€ƒMongoDBæ˜¯ä¸€ä¸ªä»‹äºå…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“ä¸­ä¸­é—´çš„äº§å“ï¼MongoDBæ˜¯éå…³ç³»å‹æ•°æ®</p>
<p>åº“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»å‹æ•°æ®åº“çš„ï¼<br>â€ƒConthDB</p>
<p>åˆ—å­˜å‚¨æ•°æ®åº“<br>â€ƒHBase<br>â€ƒåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</p>
<p>å›¾åƒå…³ç³»æ•°æ®åº“<br>â€ƒâ€ƒä¸æ˜¯å­˜å‚¨å›¾å½¢çš„ï¼Œæ”¾çš„æ˜¯å…³ç³»ï¼Œæ¯”å¦‚ï¼šæœ‹å‹åœˆç¤¾äº¤ç½‘ç»œï¼Œå¹¿å‘Šæ¨èï¼</p>
<p>å››è€…å¯¹æ¯”</p>
<p>3ã€Rediså…¥é—¨<br>3.1Redis æ˜¯ä»€ä¹ˆï¼Ÿ<br>â€ƒâ€ƒ1.ï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ !<br>â€ƒâ€ƒ2.æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€<br>â€ƒâ€ƒ3.æ”¯æŒç½‘ç»œã€<br>â€ƒâ€ƒ4.å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€<br>â€ƒâ€ƒ5.Key-Valueæ•°æ®åº“ï¼Œ<br>â€ƒâ€ƒ6.å¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚<br>â€ƒâ€ƒ7.redisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº† master-slave(ä¸»ä»)åŒæ­¥ã€‚</p>
<p>å…è´¹å’Œå¼€æºï¼è¢«äººä»¬ç§°ä¹‹ä¸ºç»“æ„åŒ–æ•°æ®åº“ï¼</p>
<p>Redisèƒ½å¹²å˜›ï¼Ÿ</p>
<p>â€ƒâ€ƒ1.å†…å­˜å­˜å‚¨ã€æŒä¹…åŒ–ï¼Œå†…å­˜ä¸­æ˜¯æ–­ç”µå³å¤±ã€æ‰€ä»¥è¯´æŒä¹…åŒ–å¾ˆé‡è¦ï¼ˆrdbã€aofï¼‰<br>â€ƒâ€ƒ2.æ•ˆç‡é«˜ï¼Œå¯ä»¥ç”¨äºé«˜é€Ÿç¼“å­˜<br>â€ƒâ€ƒ3.å‘å¸ƒè®¢é˜…ç³»ç»Ÿ<br>â€ƒâ€ƒ4.åœ°å›¾ä¿¡æ¯åˆ†æ<br>â€ƒâ€ƒ5.è®¡æ—¶å™¨ã€è®¡æ•°å™¨ï¼ˆæµè§ˆé‡ï¼ï¼‰</p>
<p>Redis ç‰¹æ€§ï¼Ÿ<br>â€ƒâ€ƒ1.å¤šæ ·çš„æ•°æ®ç±»å‹<br>â€ƒâ€ƒ2.æŒä¹…åŒ–<br>â€ƒâ€ƒ3.é›†ç¾¤<br>â€ƒâ€ƒ4.äº‹åŠ¡</p>
<p>3.2windows å®‰è£…Redis<br>1ã€ä¸‹è½½å®‰è£…åŒ…</p>
<p>2ã€ä¸‹è½½å®Œæ¯•å¾—åˆ°å‹ç¼©åŒ…ï¼š</p>
<p>3ã€è§£å‹åˆ°è‡ªå·±ç”µè„‘ä¸Šçš„ç¯å¢ƒç›®å½•ä¸‹çš„å°±å¯ä»¥çš„ï¼Redis ååˆ†çš„å°ï¼Œåªæœ‰5M</p>
<p>4ã€å¼€å¯Redisï¼Œ</p>
<p>5ã€ä½¿ç”¨rediså®¢æˆ·å•æ¥æ¥è¿æ¥redis</p>
<p>3.3Linux å®‰è£…Redis<br>1ã€ä¸‹è½½å®‰è£…åŒ…ï¼</p>
<p>2ã€è§£å‹Redisçš„å®‰è£…åŒ…ï¼</p>
<p>tar -zxvf redis-6.2.3.tar.gz<br>1</p>
<p>3ã€è¿›å…¥è§£å‹åçš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬redisçš„é…ç½®æ–‡ä»¶</p>
<p>cd redis-6.2.3&#x2F;<br>1</p>
<p>4ã€åŸºæœ¬çš„ç¯å¢ƒå®‰è£…</p>
<p>yum install gcc-c++<br>1<br>åˆ†å¼€æ‰§è¡Œ</p>
<p>make &amp;&amp; make install<br>1</p>
<p>5ã€redisçš„é»˜è®¤å®‰è£…è·¯å¾„</p>
<p>whereis redis<br>1</p>
<p>6ã€å°†redisé…ç½®æ–‡ä»¶ã€‚å¤åˆ¶åˆ°æˆ‘ä»¬å½“å‰ç›®å½•ä¸‹</p>
<p>cp &#x2F;usr&#x2F;local&#x2F;redis&#x2F;redis.conf .redis.conf<br>1</p>
<p>7ã€redisé»˜è®¤ä¸æ˜¯åå°å¯åŠ¨çš„ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼<br>è®¾ç½®ä¸ºyes</p>
<p>8ã€å¯åŠ¨RedisæœåŠ¡ï¼</p>
<p>cd &#x2F;usr&#x2F;local&#x2F;redis&#x2F;bin&#x2F;<br>1<br>&#x2F;home&#x2F;wrz&#x2F;redis-6.2.3&#x2F;redis.conf è¿™ä¸ªè·¯å¾„æ˜¯å‰é¢æŠŠconf æ–‡ä»¶å¤åˆ¶çš„è·¯å¾„</p>
<p>.&#x2F;redis-server ..&#x2F;redis.conf<br>1</p>
<p>9ã€ä½¿ç”¨redis-cli è¿›è¡Œè¿æ¥æµ‹è¯•ï¼</p>
<p>redis-cli -p 6379<br>1</p>
<p>10ã€æŸ¥çœ‹redisçš„è¿›ç¨‹æ˜¯å¦å¼€å¯ï¼</p>
<p>ps -ef | grep redis<br>1</p>
<p>11ã€å¦‚ä½•å…³é—­RedisæœåŠ¡å‘¢ï¼Ÿ<br>å…³é—­redis</p>
<p>shutdown<br>1<br>é€€å‡ºredis</p>
<p>exit<br>1</p>
<p>12ã€å†æ¬¡æŸ¥çœ‹è¿›ç¨‹æ˜¯å¦å­˜åœ¨</p>
<p>ps -ef | grep redis<br>1</p>
<p>3.4æ€§èƒ½æµ‹è¯•<br>redis-benchmark æ˜¯ä¸€ä¸ªå‹åŠ›æµ‹è¯•å·¥å…·ï¼<br>å®˜æ–¹è‡ªå¸¦çš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼<br>redis-benchmark å‘½ä»¤å‚æ•°</p>
<p>ç®€å•æµ‹è¯•</p>
<p>æµ‹è¯• 100ä¸ªå¹¶å‘è¿æ¥ 100000<br>redis-benchmark -h localhost -p 6379 -c 100 -n 100000<br>1<br>2</p>
<p>3.5Redis æ˜¯å•çº¿ç¨‹çš„<br>â€ƒâ€ƒæ˜ç™½redis æ˜¯å¾ˆå¿«çš„ï¼Œå®˜æ–¹è¡¨ç¤ºï¼ŒRedisæ˜¯åŸºäºå†…å­˜æ“ä½œçš„ï¼ŒCPUä¸æ˜¯Redisçš„æ€§èƒ½ç“¶é¢ˆï¼ŒRedisçš„ç“¶é¢ˆæ˜¯æ ¹æ®æœºå™¨çš„çš„å†…å­˜å’Œç½‘ç»œå¸¦å®½ï¼Œæ—¢å¯ä»¥ä½¿ç”¨å•çº¿ç¨‹æ¥å®ç°ï¼Œå°±ä½¿ç”¨å•çº¿ç¨‹äº†ï¼</p>
<p>Redis ä¸ºä»€ä¹ˆå•çº¿ç¨‹è¿˜è¿™ä¹ˆå¿«ï¼Ÿ<br>â€ƒâ€ƒRedisæ˜¯Cè¯­è¨€å†™çš„ï¼Œå®˜æ–¹æä¾›æ•°æ®ä¸º100000+çš„QPSï¼Œå®Œå…¨ä¸æ¯”åŒæ ·å¼ä½¿ç”¨key-alueçš„Memecacheå·®ï¼<br>â€ƒâ€ƒè¯¯åŒº1ï¼šé«˜æ€§èƒ½çš„æœåŠ¡å™¨ä¸€å®šæ˜¯å¤šçº¿ç¨‹çš„ï¼Ÿ<br>â€ƒâ€ƒè¯¯åŒº2ï¼šå¤šçº¿ç¨‹ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼ï¼‰ä¸€å®šæ¯”å•çº¿ç¨‹æ•ˆç‡é«˜ï¼<br>â€ƒâ€ƒCPUã€å†…å­˜ã€ç¡¬ç›˜çš„é€Ÿåº¦è¦æœ‰æ‰€äº†è§£<br>â€ƒâ€ƒCPUã€‹å†…å­˜ã€‹ç¡¬ç›˜<br>â€ƒâ€ƒæ ¸å¿ƒï¼šRedis æ˜¯å°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è¯´ä½¿ç”¨å•çº¿ç¨‹å»æ“ä½œæ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼Œå¤šçº¿ç¨‹ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼šè€—æ—¶çš„æ“ä½œï¼ï¼ï¼ï¼‰ï¼Œå¯¹å†…å­˜ç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢æ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼å¤šæ¬¡è¯»å†™éƒ½æ˜¯åœ¨ä¸€ä¸ªCPUä¸Šçš„ï¼Œåœ¨å†…å­˜æƒ…å†µä¸‹ï¼Œè¿™å°±æ˜¯æœ€ä½³çš„æ–¹æ¡ˆï¼</p>
<p>4ã€RedisåŸºæœ¬çŸ¥è¯†<br>redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“</p>
<p>é»˜è®¤ä½¿ç”¨ç¬¬0ä¸ª</p>
<p>å¯ä»¥ä½¿ç”¨ select è¿›è¡Œåˆ‡æ¢æ•°æ®åº“ï¼</p>
<p>æŸ¥çœ‹dbå¤§å°ï¼</p>
<p>dbsize<br>1</p>
<p>æŸ¥çœ‹æ‰€æœ‰çš„key</p>
<p>keys *<br>1</p>
<p>æ¸…ç©ºå½“å‰æ•°æ®åº“</p>
<p>flushdb<br>1</p>
<p>æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</p>
<p>flushdball<br>1</p>
<p>5ã€Redisæ“ä½œ<br>5.1Keyæ“ä½œ<br>set<br>get<br>exists<br>move<br>ttl<br>type<br>keys *<br>#è®¾ç½®<br>set XXX</p>
<p>#è·å–<br>get XXX</p>
<p>#åˆ¤æ–­å½“å‰key æ˜¯å¦å­˜åœ¨<br>exists XXX</p>
<p>#ç§»é™¤æŸä¸ªkey<br>move xxx 1</p>
<p>#è®¾ç½®æŸä¸ªkey è‡ªåŠ¨è¿‡æœŸ<br>expire xxx è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰</p>
<p>#æŸ¥çœ‹è¿˜æœ‰å¤šå°‘ç§’è¿‡æœŸ<br>ttl xxx<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>127.0.0.1:6379&gt; keys * #æŸ¥çœ‹æ‰€æœ‰key<br>(empty array)<br>127.0.0.1:6379&gt; set name xianyan #è®¾ç½®key å€¼ ä¸ºxianyan<br>OK<br>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œnameâ€<br>127.0.0.1:6379&gt; set age a #è®¾ç½®key å€¼ä¸ºa<br>OK<br>127.0.0.1:6379&gt; keys *</li>
<li>â€œageâ€</li>
<li>â€œnameâ€<br>127.0.0.1:6379&gt; exists name #åˆ¤æ–­å½“å‰key æ˜¯å¦å­˜åœ¨ 1 ä¸ºå­˜åœ¨<br>(integer) 1<br>127.0.0.1:6379&gt; move name 1 #ç§»é™¤å½“å‰key<br>(integer) 1<br>127.0.0.1:6379&gt; keys *</li>
<li>â€œageâ€<br>127.0.0.1:6379&gt; keys *</li>
<li>â€œageâ€<br>127.0.0.1:6379&gt; set name xy<br>OK<br>127.0.0.1:6379&gt; get name<br>â€œxyâ€<br>127.0.0.1:6379&gt; expire name 10 #è®¾ç½®å½“å‰key è¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’<br>(integer) 1<br>127.0.0.1:6379&gt; ttl name #æŸ¥çœ‹è¯¥key è¿˜æœ‰å¤šé•¿æ—¶é—´è¿‡æœŸ<br>(integer) 4<br>127.0.0.1:6379&gt; ttl name<br>(integer) 1<br>127.0.0.1:6379&gt; ttl name<br>(integer) -2<br>127.0.0.1:6379&gt; get name<br>(nil)<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>expire ç”¨é€”ï¼šå•ç‚¹ç™»å½•</li>
</ol>
<p>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œageâ€<br>127.0.0.1:6379&gt; type name #æŸ¥çœ‹å½“å‰key çš„ç±»å‹<br>none<br>127.0.0.1:6379&gt; set name xiany<br>OK<br>127.0.0.1:6379&gt; type name<br>string<br>127.0.0.1:6379&gt; type age<br>string<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>5.2Stringç±»å‹<br>90% çš„javaç¨‹åºå‘˜ä½¿ç”¨redis åªä¼šä½¿ç”¨ä¸€ä¸ªString ç±»å‹</li>
</ol>
<p>set<br>get<br>mset<br>mget<br>keys *<br>exists<br>append<br>strlen<br>incr<br>decr<br>incrby<br>decrby<br>getrange<br>setrange<br>setex<br>setnx<br>getset<br>127.0.0.1:6379&gt; set key1 v1 #è®¾ç½®å€¼<br>OK<br>127.0.0.1:6379&gt; get key1 #è·å¾—å€¼<br>â€œv1â€<br>127.0.0.1:6379&gt; keys * #è·å¾—æ‰€æœ‰key</p>
<ol>
<li>â€œkey1â€<br>127.0.0.1:6379&gt; exists key1 #åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨<br>(integer) 1<br>127.0.0.1:6379&gt; append key1 â€œhelloâ€ #è¿½åŠ å­—ç¬¦ä¸²ï¼Œå¦‚æœkey ä¸å­˜åœ¨ï¼Œå°±ç›¸å½“äºset key<br>(integer) 7<br>127.0.0.1:6379&gt; get key1<br>â€œv1helloâ€<br>127.0.0.1:6379&gt; strlen key1 #è·å–key é•¿åº¦<br>(integer) 7<br>127.0.0.1:6379&gt; append key1 â€˜xianyanâ€™<br>(integer) 14<br>127.0.0.1:6379&gt; get key1<br>â€œv1helloxianyanâ€<br>127.0.0.1:6379&gt; strlen key1<br>(integer) 14<br>127.0.0.1:6379&gt;<br>y<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>è‡ªå¢</li>
</ol>
<p>i++<br>æ­¥é•¿ i+&#x3D;<br>127.0.0.1:6379&gt; set views 0 #åˆå§‹æµè§ˆé‡ä¸º0<br>OK<br>127.0.0.1:6379&gt; get views<br>â€œ0â€<br>127.0.0.1:6379&gt; incr views #è‡ªå¢1 æµè§ˆé‡+1<br>(integer) 1<br>127.0.0.1:6379&gt; incr views<br>(integer) 2<br>127.0.0.1:6379&gt; get views<br>â€œ2â€<br>127.0.0.1:6379&gt; decr views #è‡ªå‡1<br>(integer) 1<br>127.0.0.1:6379&gt; decr views<br>(integer) 0<br>127.0.0.1:6379&gt; get views<br>â€œ0â€<br>127.0.0.1:6379&gt; incrby views 10 # è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå¢é‡<br>(integer) 10<br>127.0.0.1:6379&gt; decrby views 5<br>(integer) 5<br>127.0.0.1:6379&gt; incrby views 10<br>(integer) 15<br>127.0.0.1:6379&gt; decrby views 1<br>(integer) 14<br>127.0.0.1:6379&gt; get views<br>â€œ14â€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>å­—ç¬¦ä¸²èŒƒå›´</p>
<p>127.0.0.1:6379&gt; set key1 â€œhello,xyâ€ #è®¾ç½®key1çš„å€¼<br>OK<br>127.0.0.1:6379&gt; get key1<br>â€œhello,xyâ€<br>127.0.0.1:6379&gt; getrange key1 0 3 #æˆªå–å­—ç¬¦ä¸²ï¼ŒåŒºé—´çš„ã€0,1,2,3ã€‘<br>â€œhellâ€<br>127.0.0.1:6379&gt; getrange key1 0 -1 #è·å–å…¨éƒ¨å­—ç¬¦ä¸² å’Œget key æ˜¯ä¸€æ ·çš„<br>â€œhello,xyâ€<br>æ›¿æ¢å­—ç¬¦ä¸²<br>127.0.0.1:6379&gt; set key2 abcdef<br>OK<br>127.0.0.1:6379&gt; get key2<br>â€œabcdefâ€<br>127.0.0.1:6379&gt; setrange key2 1 xx #æ›¿æ¢æŒ‡å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²<br>(integer) 6<br>127.0.0.1:6379&gt; get key2<br>â€œaxxdefâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>å½“å‰è¿™ä¸ªå€¼ä¸å­˜åœ¨<br>â€ƒâ€ƒsetexè®¾ç½®è¿‡æœŸæ—¶é—´<br>â€ƒâ€ƒsetnxä¸å­˜åœ¨è®¾ç½®ï¼Œï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼ï¼‰</p>
<p>127.0.0.1:6379&gt; setex key3 30 â€œhelloâ€ #è®¾ç½®key3çš„å€¼ä¸ºhelloï¼Œ30ç§’åè¿‡æœŸ<br>OK<br>127.0.0.1:6379&gt; get key3<br>â€œhelloâ€<br>127.0.0.1:6379&gt; setnx mykey â€œredisâ€ #å¦‚æœmykeyä¸å­˜åœ¨ï¼Œåˆ›å»ºmykey<br>(integer) 1<br>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œkey1â€</li>
<li>â€œmykeyâ€</li>
<li>â€œkey3â€</li>
<li>â€œkey2â€<br>127.0.0.1:6379&gt; ttl key3<br>(integer) -2 #è¿‡æœŸäº†ï¼Œè¿”å›-2<br>127.0.0.1:6379&gt; setnx mykey â€œmongodbâ€ #ä¸å­˜åœ¨å°±è®¾ç½®ä¸º mongodb<br>(integer) 0<br>127.0.0.1:6379&gt; get mykey #è¿™ä¸ªå€¼å­˜åœ¨ æ‰€ä»¥è¿˜æ˜¯redis<br>â€œredisâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>æ‰¹é‡è®¾ç½®<br>â€ƒâ€ƒmset<br>â€ƒâ€ƒmget</li>
</ol>
<p>127.0.0.1:6379&gt; keys *<br>(empty array)<br>127.0.0.1:6379&gt; mset key1 v1 key2 v2 key3 v3 #åŒæ—¶è®¾ç½®å¤šä¸ªå€¼<br>OK<br>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œkey1â€</li>
<li>â€œkey3â€</li>
<li>â€œkey2â€<br>127.0.0.1:6379&gt; mget key1 key2 key3 #åŒæ—¶è·å–å¤šä¸ªå€¼</li>
<li>â€œv1â€</li>
<li>â€œv2â€</li>
<li>â€œv3â€</li>
</ol>
<p>#msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ï¼<br>127.0.0.1:6379&gt; msetnx key1 v1 key4 v4<br>(integer) 0<br>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œkey1â€</li>
<li>â€œkey3â€</li>
<li>â€œkey2â€<br>127.0.0.1:6379&gt; get key4<br>(nil)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>å¯¹è±¡</li>
</ol>
<p>#è®¾ç½®ä¸€ä¸ªuser:1 å¯¹è±¡ï¼Œå€¼ä¸ºjsonå­—ç¬¦ä¸²æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼<br>127.0.0.1:6379&gt; set user:1 {name:xy,age:3}<br>OK<br>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œkey1â€</li>
<li>â€œuser:1â€</li>
<li>â€œkey3â€</li>
<li>â€œkey2â€<br>127.0.0.1:6379&gt; get user:1<br>â€œ{name:xy,age:3}â€<br>127.0.0.1:6379&gt;</li>
</ol>
<p>127.0.0.1:6379&gt; mset user:2:name xianyan user:2:age 3<br>OK<br>127.0.0.1:6379&gt; get user:2:name<br>â€œxianyanâ€<br>127.0.0.1:6379&gt; mget user:2:name user:2:age</p>
<ol>
<li>â€œxianyanâ€</li>
<li>â€œ3â€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>get set å…ˆè·å–å†è®¾ç½®</li>
</ol>
<p>127.0.0.1:6379&gt; getset db redis #è·å–ä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å› nil<br>(nil)<br>127.0.0.1:6379&gt; get db<br>â€œredisâ€<br>127.0.0.1:6379&gt; getset db â€œmongodbâ€ #è·å–åŸæ¥çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼<br>â€œredisâ€<br>127.0.0.1:6379&gt; get db<br>â€œmongodbâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>æ•°æ®ç»“æ„æ˜¯ç›¸åŒçš„ï¼<br>Stringç±»å‹çš„ä½¿ç”¨åœºæ™¯ï¼švalueé™¤äº†æ˜¯æˆ‘ä»¬çš„å­—ç¬¦ä¸²è¿˜å¯ä»¥æ˜¯æˆ‘ä»¬çš„æ•°å­—<br>è®¡æ•°å™¨<br>ç»Ÿè®¡å¤šå•ä½çš„æ•°é‡<br>åˆ†æ•°æ•°<br>å¯¹è±¡ç¼“å­˜å­˜å‚¨ï¼<br>5.3Listï¼ˆåˆ—è¡¨ï¼‰<br>åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ—è¡¨</p>
<p>â€ƒâ€ƒåœ¨redisé‡Œé¢ï¼Œå¯ä»¥æŠŠlistå®Œæˆï¼Œæ ˆï¼Œé˜Ÿåˆ—ï¼Œé˜»å¡é˜Ÿåˆ—ï¼<br>â€ƒâ€ƒæ‰€æœ‰çš„listå‘½ä»¤éƒ½æ˜¯ç”¨lå¼€å¤´çš„ï¼ŒRedisä¸åŒºåˆ†å¤§å°å†™</p>
<p>lpush #å°†ä¸€ä¸ªå€¼ï¼Œæˆ–è€…å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨çš„å¤´éƒ¨<br>lrange<br>lpop<br>rpop<br>llen<br>lrem<br>lrange<br>ltrim<br>rpush<br>rpoplpush<br>linsert<br>lset<br>lindex<br>å·¦</p>
<p>127.0.0.1:6379&gt; lpush list one #å°†ä¸€ä¸ªå€¼ï¼Œæˆ–è€…å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨çš„å¤´éƒ¨<br>(integer) 1<br>127.0.0.1:6379&gt; lpush list two<br>(integer) 2<br>127.0.0.1:6379&gt; lpush list three<br>(integer) 3<br>127.0.0.1:6379&gt; lrange list 0 -1 #è·å–listä¸­çš„å€¼</p>
<ol>
<li>â€œthreeâ€</li>
<li>â€œtwoâ€</li>
<li>â€œoneâ€<br>127.0.0.1:6379&gt; lrange list 0 1 #é€šè¿‡åŒºé—´è·å–å…·ä½“çš„å€¼</li>
<li>â€œthreeâ€</li>
<li>â€œtwoâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>å³</li>
</ol>
<p>127.0.0.1:6379&gt; rpush list right #å°†ä¸€ä¸ªå€¼ï¼Œæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨çš„å°¾éƒ¨<br>(integer) 4<br>127.0.0.1:6379&gt; lrange list 0 -1</p>
<ol>
<li>â€œthreeâ€</li>
<li>â€œtwoâ€</li>
<li>â€œoneâ€</li>
<li>â€œrightâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>ç§»é™¤</li>
</ol>
<p>127.0.0.1:6379&gt; lrange list 0 -1</p>
<ol>
<li>â€œthreeâ€</li>
<li>â€œtwoâ€</li>
<li>â€œoneâ€</li>
<li>â€œrightâ€<br>127.0.0.1:6379&gt; lpop list #ç§»é™¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ <br>â€œthreeâ€<br>127.0.0.1:6379&gt; rpop list #ç§»é™¤listçš„æœ€åä¸€ä¸ªå…ƒç´ <br>â€œrightâ€<br>127.0.0.1:6379&gt; lrange list 0 -1</li>
<li>â€œtwoâ€</li>
<li>â€œoneâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>é€šè¿‡ä¸‹æ ‡è·å–listä¸­çš„æŸä¸€ä¸ªå€¼</li>
</ol>
<p>127.0.0.1:6379&gt; lrange list 0 -1</p>
<ol>
<li>â€œtwoâ€</li>
<li>â€œoneâ€<br>127.0.0.1:6379&gt; lindex list 1<br>â€œoneâ€<br>127.0.0.1:6379&gt; lindex list 0<br>â€œtwoâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>è·å–listé•¿åº¦</li>
</ol>
<p>127.0.0.1:6379&gt; llen list #è·å–listçš„é•¿åº¦<br>(integer) 2<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>ç§»é™¤æŒ‡å®šçš„å€¼<br>â€ƒâ€ƒå–å…³ uid<br>â€ƒâ€ƒlrem</p>
<p>127.0.0.1:6379&gt; lrange list 0 -1</p>
<ol>
<li>â€œfourâ€</li>
<li>â€œthreeâ€</li>
<li>â€œthreeâ€</li>
<li>â€œtwoâ€</li>
<li>â€œoneâ€<br>127.0.0.1:6379&gt; lrem list 1 one #ç§»é™¤listé›†åˆä¸­æŒ‡å®šä¸ªæ•°çš„value<br>(integer) 1<br>127.0.0.1:6379&gt; lrange list 0 -1</li>
<li>â€œfourâ€</li>
<li>â€œthreeâ€</li>
<li>â€œthreeâ€</li>
<li>â€œtwoâ€<br>127.0.0.1:6379&gt; lrem list 2 three<br>(integer) 2<br>127.0.0.1:6379&gt; lrange list 0 -1</li>
<li>â€œfourâ€</li>
<li>â€œtwoâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>trim ä¿®å‰ªæ“ä½œï¼šlist æˆªæ–­</li>
</ol>
<p>127.0.0.1:6379&gt; lrange mylist 0 -1</p>
<ol>
<li>â€œhelloâ€</li>
<li>â€œhello1â€</li>
<li>â€œhello2â€</li>
<li>â€œhello3â€<br>127.0.0.1:6379&gt; ltrim mylist 1 2 #é€šè¿‡ä¸‹æ ‡ï¼Œæˆªå–æŒ‡å®šçš„é•¿åº¦<br>OK<br>127.0.0.1:6379&gt; lrange mylist 0 -1</li>
<li>â€œhello1â€</li>
<li>â€œhello2â€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>list å·²ç»è¢«æ”¹å˜äº†ï¼Œæˆªæ–­äº†åªå‰©ä¸‹æˆªå–é¢å…ƒç´ ï¼</li>
</ol>
<p>ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¢«ç§»é™¤çš„å…ƒç´ æ·»åŠ åˆ°æ–°çš„åˆ—è¡¨ä¸­</p>
<p>127.0.0.1:6379&gt; rpush mylist hello hello1 hello2<br>(integer) 3<br>127.0.0.1:6379&gt; rpoplpush mylist myother #ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¢«ç§»é™¤çš„å…ƒç´ æ·»åŠ åˆ°æ–°çš„åˆ—è¡¨ä¸­<br>â€œhello2â€<br>127.0.0.1:6379&gt; lrange mylist 0 -1 #æŸ¥çœ‹å½“å‰åˆ—è¡¨</p>
<ol>
<li>â€œhelloâ€</li>
<li>â€œhello1â€<br>127.0.0.1:6379&gt; lrange myother 0 -1 #æŸ¥çœ‹ç›®æ ‡åˆ—è¡¨ä¸­ï¼Œç¡®å®å­˜åœ¨è¯¥å€¼</li>
<li>â€œhello2â€<br>lset å°†åˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡çš„å€¼ï¼Œæ›¿æ¢ä¸ºå¦å¤–ä¸€ä¸ªå€¼ï¼Œæ›´æ–°æ“ä½œï¼Œå¿…é¡»å­˜åœ¨è¦æ›´æ–°çš„åˆ—è¡¨<br>127.0.0.1:6379&gt; lpush list value<br>(integer) 1<br>127.0.0.1:6379&gt; lrange list 0 0</li>
<li>â€œvalueâ€<br>127.0.0.1:6379&gt; lset list 0 item<br>OK<br>127.0.0.1:6379&gt; lrange list 0 0</li>
<li>â€œitemâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>linsert æ’å…¥å…ƒç´ ï¼Œå°†æŸä¸ªå…·ä½“çš„value æ’å…¥åˆ°åˆ—è¡¨ä¸­æŸä¸ªå…ƒç´ çš„å‰é¢æˆ–è€…åé¢</li>
</ol>
<p>127.0.0.1:6379&gt; linsert list before â€œitemâ€ â€œotherâ€ #åœ¨ item åé¢æ’å…¥å…ƒç´ <br>(integer) 2<br>127.0.0.1:6379&gt; lrange list 0 -1</p>
<ol>
<li>â€œotherâ€</li>
<li>â€œitemâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>æ€»ç»“ï¼š</li>
</ol>
<p>å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œbefore Node afterï¼Œlist right éƒ½å¯ä»¥æ’å…¥å€¼<br>å¦‚æœå¯ä»¥ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„é“¾è¡¨<br>å¦‚æœkeyå­˜åœ¨ï¼Œæ–°å¢å†…å®¹<br>å¦‚æœç§»é™¤äº†æ‰€æœ‰å€¼ï¼Œç©ºé“¾è¡¨ï¼Œä¹Ÿä»£è¡¨ä¸å­˜åœ¨<br>åœ¨ä¸¤è¾¹æ’å…¥æˆ–è€…æ”¹åŠ¨å€¼ï¼Œæ•ˆç‡æœ€é«˜ï¼ä¸­é—´å…ƒç´ ï¼Œç›¸å¯¹æ¥è¯´æ•ˆç‡ä¼šä½ä¸€ç‚¹<br>5.4.Set ï¼ˆé›†åˆï¼‰<br>setä¸­çš„å€¼æ˜¯ä¸èƒ½é‡å¤çš„</p>
<p>sadd<br>smembers<br>sismember<br>scard<br>sadd<br>srem<br>srem<br>srandmember<br>spop<br>smove<br>sdiff<br>sinter<br>sunion<br>127.0.0.1:6379&gt; sadd myset hello #seté›†åˆä¸­æ·»åŠ å…ƒç´ <br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset xianyan<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset xy<br>(integer) 1</p>
<p>127.0.0.1:6379&gt; smembers myset #æŸ¥çœ‹æŒ‡å®šset ä¸­çš„æ‰€æœ‰å€¼</p>
<ol>
<li>â€œxianyanâ€</li>
<li>â€œxyâ€</li>
<li>â€œhelloâ€<br>127.0.0.1:6379&gt; sismember myset hello #åˆ¤æ–­ä¸€ä¸ªå€¼åœ¨ä¸åœ¨set é›†åˆä¸­<br>(integer) 1<br>127.0.0.1:6379&gt; sismember myset word<br>(integer) 0<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>scard è·å–set é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</li>
</ol>
<p>127.0.0.1:6379&gt; scard myset<br>(integer) 3<br>127.0.0.1:6379&gt; sadd myset xy<br>(integer) 0<br>127.0.0.1:6379&gt; sadd myset xy2<br>(integer) 1<br>127.0.0.1:6379&gt; scard myset<br>(integer) 4<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>srem ç§»é™¤set é›†åˆä¸­çš„æŒ‡å®šå…ƒç´ </p>
<p>127.0.0.1:6379&gt; srem myset hello<br>(integer) 1<br>127.0.0.1:6379&gt; scard myset<br>(integer) 3<br>127.0.0.1:6379&gt; smembers myset</p>
<ol>
<li>â€œxy2â€</li>
<li>â€œxianyanâ€</li>
<li>â€œxyâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>set æ— åºï¼Œä¸é‡å¤é›†åˆ<br>æŠ½éšæœº</li>
</ol>
<p>127.0.0.1:6379&gt; srandmember myset #éšæœºæŠ½é€‰å‡ºä¸€ä¸ªå…ƒç´ <br>â€œxianyanâ€<br>127.0.0.1:6379&gt; srandmember myset<br>â€œxianyanâ€<br>127.0.0.1:6379&gt; srandmember myset<br>â€œxy2â€<br>127.0.0.1:6379&gt; srandmember myset<br>â€œxianyanâ€<br>127.0.0.1:6379&gt; srandmember myset<br>â€œxy2â€</p>
<p>127.0.0.1:6379&gt; srandmember myset 2 #éšæœºæŠ½é€‰å‡ºæŒ‡å®šä¸ªæ•°çš„å…ƒç´ </p>
<ol>
<li>â€œxy2â€</li>
<li>â€œxyâ€<br>127.0.0.1:6379&gt; srandmember myset 2</li>
<li>â€œxy2â€</li>
<li>â€œxianyanâ€<br>127.0.0.1:6379&gt; srandmember myset 2</li>
<li>â€œxy2â€</li>
<li>â€œxianyanâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>åˆ é™¤æŒ‡å®šçš„key<br>éšæœºåˆ é™¤ä¸€ä¸ªkey</li>
</ol>
<p>127.0.0.1:6379&gt; smembers myset</p>
<ol>
<li>â€œxy2â€</li>
<li>â€œxianyanâ€</li>
<li>â€œxyâ€<br>127.0.0.1:6379&gt; spop myset #éšæœºåˆ é™¤ä¸€ä¸ªset é›†åˆä¸­çš„å…ƒç´ <br>â€œxy2â€<br>127.0.0.1:6379&gt; spop myset<br>â€œxyâ€<br>127.0.0.1:6379&gt; smembers myset</li>
<li>â€œxianyanâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>å°†ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªset é›†åˆ</li>
</ol>
<p>127.0.0.1:6379&gt; smembers myset</p>
<ol>
<li>â€œworldâ€</li>
<li>â€œxyâ€</li>
<li>â€œhelloâ€<br>127.0.0.1:6379&gt; smembers myset2</li>
<li>â€œset2â€<br>127.0.0.1:6379&gt; smove myset myset2 xy<br>(integer) 1<br>127.0.0.1:6379&gt; smembers myset</li>
<li>â€œworldâ€</li>
<li>â€œhelloâ€<br>127.0.0.1:6379&gt; smembers myset2</li>
<li>â€œxyâ€</li>
<li>â€œset2â€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>å¾®åšï¼ŒBç«™ï¼Œå…±åŒå…³æ³¨ï¼ï¼ˆå¹¶é›†ï¼‰<br>æ•°å­—é›†åˆç±»ï¼š<br>â€ƒâ€ƒ1.å·®é›†<br>â€ƒâ€ƒ2.äº¤é›†<br>â€ƒâ€ƒ3.å¹¶é›†</li>
</ol>
<p>127.0.0.1:6379&gt; sadd key1 a<br>(integer) 1<br>127.0.0.1:6379&gt; sadd key1 b<br>(integer) 1<br>127.0.0.1:6379&gt; sadd key1 c<br>(integer) 1<br>127.0.0.1:6379&gt; sadd key2 c<br>(integer) 1<br>127.0.0.1:6379&gt; sadd key2 d<br>(integer) 1<br>127.0.0.1:6379&gt; sadd key2 e<br>(integer) 1<br>127.0.0.1:6379&gt; sdiff key1 key2 #å·®é›†</p>
<ol>
<li>â€œbâ€</li>
<li>â€œaâ€<br>127.0.0.1:6379&gt; sinter key1 key2 #äº¤é›† å…±åŒå¥½å‹è¿™æ ·å®ç°</li>
<li>â€œcâ€<br>127.0.0.1:6379&gt; sunion key1 key2 #å¹¶é›†</li>
<li>â€œcâ€</li>
<li>â€œeâ€</li>
<li>â€œbâ€</li>
<li>â€œaâ€</li>
<li>â€œdâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>å¾®åšï¼ŒAç”¨æˆ·å°†æ‰€æœ‰å…³æ³¨çš„äººæ”¾åœ¨ä¸€ä¸ªset é›†åˆä¸­ï¼Œå°†å®ƒçš„ç²‰ä¸ä¹Ÿæ”¾åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œ<br>å…±åŒå…³æ³¨<br>å…±åŒçˆ±å¥½<br>äºŒåº¦å¥½å‹ï¼ˆå…­åº¦åˆ†éš”ç†è®ºï¼‰<br>æ¨èå¥½å‹<br>5.5Hashï¼ˆmapé›†åˆï¼‰<br>Mapé›†åˆï¼Œkey-mapï¼æ—¶å€™è¿™ç§å€¼æ˜¯ä¸ªmap é›†åˆï¼</li>
</ol>
<p>hset<br>hmset<br>hmget<br>hgetall<br>hdel<br>hlen<br>hexists<br>hkeys<br>hincrby<br>hsetnx<br>127.0.0.1:6379&gt; hset myhash file1 xy #set ä¸€ä¸ªå…·ä½“key -value<br>(integer) 1<br>127.0.0.1:6379&gt; hget myhash file1 #è·å–ä¸€ä¸ªå­—æ®µå€¼<br>â€œxyâ€<br>127.0.0.1:6379&gt; hmset myhash file1 hello filed2 world #set å¤šä¸ª key-value<br>OK<br>127.0.0.1:6379&gt; hmget myhash file1 filed2 #è·å–å¤šä¸ªå­—æ®µå€¼</p>
<ol>
<li>â€œhelloâ€</li>
<li>â€œworldâ€<br>127.0.0.1:6379&gt; hgetall myhash #è·å–å…¨éƒ¨æ•°æ®</li>
<li>â€œfile1â€</li>
<li>â€œhelloâ€</li>
<li>â€œfiled2â€</li>
<li>â€œworldâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>åˆ é™¤</li>
</ol>
<p>127.0.0.1:6379&gt; hgetall myhash</p>
<ol>
<li>â€œfile1â€</li>
<li>â€œhelloâ€</li>
<li>â€œfiled2â€</li>
<li>â€œworldâ€<br>127.0.0.1:6379&gt; hdel myhash filed2 #åˆ é™¤hashæŒ‡å®škeyå­—æ®µï¼å¯¹åº”çš„valueæ¶ˆå¤±äº†<br>(integer) 1<br>127.0.0.1:6379&gt; hgetall myhash</li>
<li>â€œfile1â€</li>
<li>â€œhelloâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>è·å–hashè¡¨çš„å­—æ®µé•¿åº¦</li>
</ol>
<p>127.0.0.1:6379&gt; hlen myhash<br>(integer) 1<br>127.0.0.1:6379&gt; hmset myhash file1 hello file2 world<br>OK<br>127.0.0.1:6379&gt; hgetall myhash</p>
<ol>
<li>â€œfile1â€</li>
<li>â€œhelloâ€</li>
<li>â€œfile2â€</li>
<li>â€œworldâ€<br>127.0.0.1:6379&gt;<br>127.0.0.1:6379&gt; hlen myhash<br>(integer) 2<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>åˆ¤æ–­hash ä¸­æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨ï¼</li>
</ol>
<p>127.0.0.1:6379&gt; hexists myhash file1<br>(integer) 1<br>127.0.0.1:6379&gt; hexists myhash file3<br>(integer) 0<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>åªè·å¾—æ‰€æœ‰çš„ key<br>åªè·å¾—æ‰€æœ‰çš„value</p>
<p>127.0.0.1:6379&gt; hkeys myhash</p>
<ol>
<li>â€œfile1â€</li>
<li>â€œfile2â€<br>127.0.0.1:6379&gt; hvals myhash</li>
<li>â€œhelloâ€</li>
<li>â€œworldâ€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>incr<br>decr</li>
</ol>
<p>127.0.0.1:6379&gt; hset myhash file3 5 #æŒ‡å®šæ•°é‡<br>(integer) 1<br>127.0.0.1:6379&gt; hincrby myhash file3 1<br>(integer) 6<br>127.0.0.1:6379&gt; hincrby myhash file3 -1<br>(integer) 5<br>127.0.0.1:6379&gt; hsetnx myhash file4 hello #å¦‚æœä¸å­˜åœ¨åˆ™å¯ä»¥è®¾ç½®<br>(integer) 1<br>127.0.0.1:6379&gt; hsetnx myhash file4 word #å¦‚æœå­˜åœ¨åˆ™ä¸èƒ½è®¾ç½®<br>(integer) 0<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>â€ƒâ€ƒhashå˜æ›´çš„æ•°æ®user name age ï¼Œå°¤å…¶æ˜¯ç”¨æˆ·ä¿¡æ¯ä¹‹ç±»ï¼Œç»å¸¸å˜åŠ¨çš„ä¿¡æ¯ï¼hash æ›´é€‚åˆå¯¹è±¡çš„å­˜å‚¨ï¼ŒString æ›´é€‚åˆå­—ç¬¦ä¸²</p>
<p>127.0.0.1:6379&gt; hset user:1 name xy<br>(integer) 1<br>127.0.0.1:6379&gt; keys *</p>
<ol>
<li>â€œuser:1â€</li>
<li>â€œmyhashâ€<br>127.0.0.1:6379&gt; hget user:1 name<br>â€œxyâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>5.6Zsetï¼ˆæœ‰åºé›†åˆï¼‰<br>åœ¨setçš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ªå€¼ï¼Œset k1 v1<br>zset k1 score1 v1</li>
</ol>
<p>zadd<br>zrange<br>zrangebyscore<br>zrem<br>zcount<br>zrevrange<br>127.0.0.1:6379&gt; zadd myset 1 one #æ·»åŠ ä¸€ä¸ªå€¼<br>(integer) 1<br>127.0.0.1:6379&gt;<br>127.0.0.1:6379&gt; zadd myset 2 two 3 three #æ·»åŠ å¤šä¸ªå€¼<br>(integer) 2<br>127.0.0.1:6379&gt; zrange myset 0 -1</p>
<ol>
<li>â€œoneâ€</li>
<li>â€œtwoâ€</li>
<li>â€œthreeâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>æ’åºå®ç°</li>
</ol>
<p>127.0.0.1:6379&gt; zrange myset 0 -1</p>
<ol>
<li>â€œoneâ€</li>
<li>â€œtwoâ€</li>
<li>â€œthreeâ€<br>127.0.0.1:6379&gt; zadd salary 2500 xiaohuang #æ·»åŠ ä¸‰ä¸ªç”¨æˆ·<br>(integer) 1<br>127.0.0.1:6379&gt; zadd salary 5000 zhangsan<br>(integer) 1<br>127.0.0.1:6379&gt; zadd salary 500 xy<br>(integer) 1<br>127.0.0.1:6379&gt; zrangebyscore salary -inf +inf #æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·ï¼Œä»å°åˆ°å¤§</li>
<li>â€œxyâ€</li>
<li>â€œxiaohuangâ€</li>
<li>â€œzhangsanâ€<br>127.0.0.1:6379&gt; zrangebyscore salary 0 -1<br>(empty array)<br>127.0.0.1:6379&gt; zrangebyscore salary 0 -1 with scores<br>(error) ERR syntax error<br>127.0.0.1:6379&gt; zrangebyscore salary 0 -1 withscores<br>(empty array)<br>127.0.0.1:6379&gt; zrangebyscore salary +inf -inf<br>(empty array)<br>127.0.0.1:6379&gt; zrangebyscore salary -inf +inf</li>
<li>â€œxyâ€</li>
<li>â€œxiaohuangâ€</li>
<li>â€œzhangsanâ€<br>127.0.0.1:6379&gt; zrangebyscore salary 0 -1<br>(empty array)</li>
</ol>
<p>#æ˜¾ç¤ºå…¨éƒ¨çš„ç”¨æˆ·å¹¶é™„å¸¦æˆç»©<br>127.0.0.1:6379&gt; zrangebyscore salary -inf +inf withscores</p>
<ol>
<li>â€œxyâ€</li>
<li>â€œ500â€</li>
<li>â€œxiaohuangâ€</li>
<li>â€œ2500â€</li>
<li>â€œzhangsanâ€</li>
<li>â€œ5000â€</li>
</ol>
<p>#æ˜¾ç¤ºå·¥èµ„å°äº2500å‘˜å·¥çš„å‡åºæ’åº<br>127.0.0.1:6379&gt; zrangebyscore salary -inf 2500 withscores</p>
<ol>
<li>â€œxyâ€</li>
<li>â€œ500â€</li>
<li>â€œxiaohuangâ€</li>
<li>â€œ2500â€<br>127.0.0.1:6379&gt; zrangebyscore salary +inf -inf<br>(empty array)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>ç§»é™¤remä¸­çš„å…ƒç´ </li>
</ol>
<p>127.0.0.1:6379&gt; zrange salary 0 -1</p>
<ol>
<li>â€œxyâ€</li>
<li>â€œxiaohuangâ€</li>
<li>â€œzhangsanâ€<br>127.0.0.1:6379&gt; zrem salary xiaohuang #ç§»é™¤æœ‰åºé›†åˆä¸­çš„æŒ‡å®šå…ƒç´ <br>(integer) 1<br>127.0.0.1:6379&gt; zrange salary 0 -1</li>
<li>â€œxyâ€</li>
<li>â€œzhangsanâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>è·å–æœ‰åºé›†åˆä¸­çš„ä¸ªæ•°</li>
</ol>
<p>127.0.0.1:6379&gt; zcard salary<br>(integer) 2<br>1<br>2<br>ä»å¤§åˆ°å°è¿›è¡Œæ’åº</p>
<p>127.0.0.1:6379&gt; zrevrange salary 0 -1 #ä»å¤§åˆ°å°è¿›è¡Œæ’åº</p>
<ol>
<li>â€œzhangsanâ€</li>
<li>â€œxyâ€<br>1<br>2<br>3<br>zcount è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡</li>
</ol>
<p>127.0.0.1:6379&gt; zadd myset 1 hello<br>(integer) 1<br>127.0.0.1:6379&gt; zadd myset 2 world 3 xy #è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡<br>(integer) 2<br>127.0.0.1:6379&gt; zcount myset 1 3<br>(integer) 3<br>127.0.0.1:6379&gt; zcount myset 1 2<br>(integer) 2<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>æ¡ˆä¾‹æ€è·¯ï¼š<br>â€ƒâ€ƒset æ’åº å­˜å‚¨ç­çº§æˆç»©è¡¨ï¼Œå·¥èµ„è¡¨æ’åºï¼<br>â€ƒâ€ƒæ™®é€šæ¶ˆæ¯ï¼Œ1ï¼Œé‡è¦æ¶ˆæ¯2ï¼Œå¸¦æƒé‡åˆ¤æ–­</p>
<p>6ã€geospatial åœ°ç†ä½ç½®<br>â€ƒâ€ƒæœ‹å‹çš„å®šä½ï¼Œé™„è¿‘çš„äººï¼Œæ‰“è½¦è·ç¦»è®¡ç®—ï¼Ÿ<br>â€ƒâ€ƒRedis çš„Geo åœ¨Redis 3.2ç‰ˆæœ¬ å°±æ¨å‡ºäº†ï¼è¿™ä¸ªåŠŸèƒ½å¯ä»¥æ¨ç®—åœ°ç†ä½ç½®çš„ä¿¡æ¯ï¼Œä¸¤åœ°ä¹‹é—´çš„è·ç¦»ï¼Œæ–¹åœ†å‡ é‡Œçš„äººï¼</p>
<p>åªæœ‰å…­ä¸ªå‘½ä»¤</p>
<p>æ·»åŠ åœ°ç†ä½ç½®<br>è§„åˆ™ï¼šä¸¤çº§æ— æ³•ç›´æ¥æ·»åŠ ï¼Œä¸€èˆ¬ä¸‹è½½åŸå¸‚æ•°æ®ï¼Œç›´æ¥é€šè¿‡javaç¨‹åº ä¸€æ¬¡æ€§å¯¼å…¥ï¼<br>å‚æ•° key å€¼ï¼ˆï¼‰<br>geoadd</p>
<p>127.0.0.1:6379&gt; geoadd china:city: 116.40 39.90 beijing<br>(integer) 1<br>127.0.0.1:6379&gt; geoadd china:city: 121.47 31.23 shanghai<br>(integer) 1<br>127.0.0.1:6379&gt; geoadd china:city: 106.50 29.53 chongqing<br>(integer) 1<br>127.0.0.1:6379&gt; geoadd china:city: 114.08 22.53 shenzhen<br>(integer) 1<br>127.0.0.1:6379&gt; geoadd china:city 120.16 30.24 hangzhou 108.96 34.26 xian<br>(integer) 2<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>geopos<br>è·å–å½“å‰å®šä½ï¼Œä¸€å®šæ˜¯ä¸€ä¸ªåæ ‡å€¼ï¼</p>
<p>127.0.0.1:6379&gt; geopos china:city: beijing #è·å–æŒ‡å®šçš„åŸå¸‚çš„ç»åº¦å’Œçº¬åº¦ï¼</p>
<ol>
<li><ol>
<li>â€œ116.39999896287918091â€</li>
<li>â€œ39.90000009167092543â€<br>127.0.0.1:6379&gt; geopos china:city: shanghai</li>
</ol>
</li>
<li><ol>
<li>â€œ121.47000163793563843â€</li>
<li>â€œ31.22999903975783553â€<br>127.0.0.1:6379&gt; geopos china:city: chongqing shenzhen hangzhou</li>
</ol>
</li>
<li><ol>
<li>â€œ106.49999767541885376â€</li>
<li>â€œ29.52999957900659211â€</li>
</ol>
</li>
<li><ol>
<li>â€œ114.08000081777572632â€</li>
<li>â€œ22.52999956292396888â€</li>
</ol>
</li>
<li>(nil)<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>ä¸¤äººä¹‹é—´çš„è·ç¦»</li>
</ol>
<p>è¿”å›ä¸¤ä¸ªç»™å®šä½ç½®ä¹‹é—´çš„è·ç¦»ã€‚<br>å¦‚æœä¸¤ä¸ªä½ç½®ä¹‹é—´çš„å…¶ä¸­ä¸€ä¸ªä¸å­˜åœ¨ï¼Œ é‚£ä¹ˆå‘½ä»¤è¿”å›ç©ºå€¼ã€‚<br>æŒ‡å®šå•ä½çš„å‚æ•° unit å¿…é¡»æ˜¯ä»¥ä¸‹å•ä½çš„å…¶ä¸­ä¸€ä¸ªï¼š<br>m è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚<br>km è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚<br>mi è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚<br>ft è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚<br>å¦‚æœç”¨æˆ·æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šå•ä½å‚æ•°ï¼Œ é‚£ä¹ˆ GEODIST é»˜è®¤ä½¿ç”¨ç±³ä½œä¸ºå•ä½ã€‚</p>
<h1 id="æŸ¥çœ‹é‡åº†åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»"><a href="#æŸ¥çœ‹é‡åº†åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»" class="headerlink" title="æŸ¥çœ‹é‡åº†åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»"></a>æŸ¥çœ‹é‡åº†åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»</h1><p>127.0.0.1:6379&gt; geodist china:city: chongqing beijing km<br>â€œ1464.0708â€</p>
<h1 id="æŸ¥çœ‹åŒ—äº¬åˆ°ä¸Šæµ·çš„ç›´çº¿è·ç¦»"><a href="#æŸ¥çœ‹åŒ—äº¬åˆ°ä¸Šæµ·çš„ç›´çº¿è·ç¦»" class="headerlink" title="æŸ¥çœ‹åŒ—äº¬åˆ°ä¸Šæµ·çš„ç›´çº¿è·ç¦»"></a>æŸ¥çœ‹åŒ—äº¬åˆ°ä¸Šæµ·çš„ç›´çº¿è·ç¦»</h1><p>127.0.0.1:6379&gt; geodist china:city: beijing shanghai km<br>â€œ1067.3788â€<br>1<br>2<br>3<br>4<br>5<br>6<br>â€ƒâ€ƒgeoradius ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œæ‰¾å‡ºæŸä¸€åŠå†…çš„å…ƒç´ <br>â€ƒâ€ƒæˆ‘é™„è¿‘çš„äººï¼Ÿï¼ˆè·å–æ‰€æœ‰é™„è¿‘çš„äººçš„åœ°å€ï¼Œå®šä½ï¼ï¼‰ é€šè¿‡åŠå¾„æ¥æŸ¥è¯¢ï¼<br>â€ƒâ€ƒæ‰€æœ‰çš„æ•°æ®åº”è¯¥éƒ½å½•å…¥ï¼šChina:city: æ‰ä¼šè®©ç»“æ„æ›´åŠ è¯·æ±‚ï¼</p>
<p>#ä»¥110 30 è¿™ä¸ªç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œå¯»æ‰¾æ–¹åœ†1000kmå†…çš„åŸå¸‚<br>127.0.0.1:6379&gt; georadius china:city: 110 30 1000 km</p>
<ol>
<li>â€œchongqingâ€</li>
<li>â€œshenzhenâ€<br>127.0.0.1:6379&gt; georadius china:city: 110 30 600 km</li>
<li>â€œchongqingâ€<br>127.0.0.1:6379&gt; georadius china:city: 110 30 500 km</li>
<li>â€œchongqingâ€</li>
</ol>
<h1 id="æ˜¾ç¤ºåˆ°ä¸­é—´è·ç¦»çš„ä½ç½®"><a href="#æ˜¾ç¤ºåˆ°ä¸­é—´è·ç¦»çš„ä½ç½®" class="headerlink" title="æ˜¾ç¤ºåˆ°ä¸­é—´è·ç¦»çš„ä½ç½®"></a>æ˜¾ç¤ºåˆ°ä¸­é—´è·ç¦»çš„ä½ç½®</h1><p>127.0.0.1:6379&gt; georadius china:city: 110 30 500 km withdist</p>
<ol>
<li><ol>
<li>â€œchongqingâ€</li>
<li>â€œ341.9374â€</li>
</ol>
</li>
</ol>
<h1 id="æ˜¾ç¤ºä»–äººçš„å®šä½ä¿¡æ¯"><a href="#æ˜¾ç¤ºä»–äººçš„å®šä½ä¿¡æ¯" class="headerlink" title="æ˜¾ç¤ºä»–äººçš„å®šä½ä¿¡æ¯"></a>æ˜¾ç¤ºä»–äººçš„å®šä½ä¿¡æ¯</h1><p>127.0.0.1:6379&gt; georadius china:city: 110 30 1000 km withdist withcoord</p>
<ol>
<li><ol>
<li>â€œchongqingâ€</li>
<li>â€œ341.9374â€</li>
<li><ol>
<li>â€œ106.49999767541885376â€</li>
<li>â€œ29.52999957900659211â€</li>
</ol>
</li>
</ol>
</li>
<li><ol>
<li>â€œshenzhenâ€</li>
<li>â€œ924.9425â€</li>
<li><ol>
<li>â€œ114.08000081777572632â€</li>
<li>â€œ22.52999956292396888â€<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>è·å–æŒ‡å®šæ•°é‡çš„äººï¼Œ200</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="ç­›é€‰å‡ºæŒ‡å®šçš„ç»“æœ"><a href="#ç­›é€‰å‡ºæŒ‡å®šçš„ç»“æœ" class="headerlink" title="ç­›é€‰å‡ºæŒ‡å®šçš„ç»“æœ"></a>ç­›é€‰å‡ºæŒ‡å®šçš„ç»“æœ</h1><p>127.0.0.1:6379&gt; georadius china:city: 110 30 1000 km withdist withcoord count 1</p>
<ol>
<li><ol>
<li>â€œchongqingâ€</li>
<li>â€œ341.9374â€</li>
<li><ol>
<li>â€œ106.49999767541885376â€</li>
<li>â€œ29.52999957900659211â€<br>127.0.0.1:6379&gt; georadius china:city: 110 30 1000 km withdist withcoord count 2</li>
</ol>
</li>
</ol>
</li>
<li><ol>
<li>â€œchongqingâ€</li>
<li>â€œ341.9374â€</li>
<li><ol>
<li>â€œ106.49999767541885376â€</li>
<li>â€œ29.52999957900659211â€</li>
</ol>
</li>
</ol>
</li>
<li><ol>
<li>â€œshenzhenâ€</li>
<li>â€œ924.9425â€</li>
<li><ol>
<li>â€œ114.08000081777572632â€</li>
<li>â€œ22.52999956292396888â€<br>127.0.0.1:6379&gt; georadius china:city: 110 30 1000 km withdist withcoord count 3</li>
</ol>
</li>
</ol>
</li>
<li><ol>
<li>â€œchongqingâ€</li>
<li>â€œ341.9374â€</li>
<li><ol>
<li>â€œ106.49999767541885376â€</li>
<li>â€œ29.52999957900659211â€</li>
</ol>
</li>
</ol>
</li>
<li><ol>
<li>â€œshenzhenâ€</li>
<li>â€œ924.9425â€</li>
<li><ol>
<li>â€œ114.08000081777572632â€</li>
<li>â€œ22.52999956292396888â€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>georadiusbymember<br>â€ƒâ€ƒè¿™ä¸ªå‘½ä»¤å’Œ GEORADIUS å‘½ä»¤ä¸€æ ·ï¼Œ éƒ½å¯ä»¥æ‰¾å‡ºä½äºæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼Œ ä½†æ˜¯ GEORADIUSBYMEMBER çš„ä¸­å¿ƒç‚¹æ˜¯ç”±ç»™å®šçš„ä½ç½®å…ƒç´ å†³å®šçš„ï¼Œ è€Œä¸æ˜¯åƒ GEORADIUS é‚£æ ·ï¼Œ ä½¿ç”¨è¾“å…¥çš„ç»åº¦å’Œçº¬åº¦æ¥å†³å®šä¸­å¿ƒç‚¹ï¼ŒæŒ‡å®šæˆå‘˜çš„ä½ç½®è¢«ç”¨ä½œæŸ¥è¯¢çš„ä¸­å¿ƒ</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>#æ‰¾å‡ºä½äºæŒ‡å®šå…ƒç´ å‘¨å›´çš„<br>127.0.0.1:6379&gt; georadiusbymember china:city: beijing 1000 km</p>
<ol>
<li>â€œbeijingâ€<br>127.0.0.1:6379&gt; georadiusbymember china:city: shanghai 400 km</li>
<li>â€œshanghaiâ€<br>1<br>2<br>3<br>4<br>5<br>7ã€Hyperloglog<br>ä»€ä¹ˆæ˜¯åŸºæ•°?<br>â€ƒâ€ƒA{1,3,5,6,8,7}<br>â€ƒâ€ƒB{1,3,5,7,8}<br>â€ƒâ€ƒåŸºæ•°ï¼ˆä¸é‡å¤çš„æ•°ï¼‰&#x3D;5ï¼Œå¯ä»¥æ¥å—è¯¯å·®ï¼</li>
</ol>
<p>ç®€ä»‹<br>â€ƒâ€ƒRedis2.8.9ç‰ˆæœ¬æ›´æ–°äº†Hyperloglog æ•°æ®ç»“æ„ï¼<br>â€ƒâ€ƒRedis Hyperloglog åŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼<br>â€ƒâ€ƒä¼˜ç‚¹ï¼šå ç”¨çš„å†…å­˜æ˜¯å›ºå®šçš„ï¼Œ2^64 ä¸åŒçš„å…ƒç´ æŠ€æœ¯ï¼Œåªéœ€è¦12kbå†…å­˜ï¼å¦‚æœè¦ä»å†…å­˜è§’åº¦æ¥æ¯”è¾ƒçš„è¯ Hyperloglog é¦–é€‰ï¼</p>
<p>ç½‘é¡µçš„UVï¼ˆä¸€ä¸ªäººè®¿é—®ç½‘ç«™å¤šæ¬¡ï¼Œä½†æ˜¯è¿˜ç®—æ˜¯ä¸€ä¸ªäººï¼‰</p>
<p>â€ƒâ€ƒä¼ ç»Ÿæ–¹å¼ï¼Œset ä¿å­˜ç”¨æˆ·çš„idï¼Œç„¶åå°±å¯ä»¥ç»Ÿè®¡set ä¸­çš„å…ƒç´  æ•°é‡ä½œä¸ºåˆ¤æ–­ï¼<br>â€ƒâ€ƒè¿™ä¸ªæ–¹å¼å¦‚æœä¿å­˜å¤§é‡çš„ç”¨æˆ·idï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼ˆå å†…å­˜ï¼‰æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·idï¼›<br>â€ƒâ€ƒ0.81%,å¯ä»¥å¿½ç•¥ä¸è®¡ï¼</p>
<p>127.0.0.1:6379&gt; pfadd mykey a b c d e f g #åˆ›å»ºç¬¬ä¸€ç»„å…ƒç´  mykey<br>(integer) 1<br>127.0.0.1:6379&gt; pfcount mykey #ç»Ÿè®¡mykey å…ƒç´ åŸºæ•° æ•°é‡<br>(integer) 7<br>127.0.0.1:6379&gt; pfadd mykey2 i j k l m n o #åˆ›å»ºç¬¬ä¸€ç»„å…ƒç´  mykey2<br>(integer) 1<br>127.0.0.1:6379&gt; pfcount mykey2<br>(integer) 7<br>127.0.0.1:6379&gt; pfmerge mykey3 mykey mykey2 #åˆå¹¶ ä¸¤ç»„ mykey mykey2 &#x3D; mykey3<br>OK<br>127.0.0.1:6379&gt; pfcount mykey3 #æŸ¥çœ‹å¹¶é›†æ•°é‡<br>(integer) 14<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>å¦‚æœå…è®¸å®¹é”™ï¼Œé‚£ä¹ˆä¸€å®šä½¿ç”¨Hyperloglogï¼<br>å¦‚æœä¸å…è®¸å®¹é”™ï¼Œå°±æ˜¯ç”¨set æˆ–è€…è‡ªå·±çš„æ•°æ®ç±»å‹å°±å¯ä»¥äº†</p>
<p>8ã€Bitmap<br>â€ƒâ€ƒåœ¨å¼€å‘ä¸­éƒ½æœ‰ååˆ†å¤šçš„åº”ç”¨åœºæ™¯ï¼Œå­¦ä¹ äº†ï¼Œå°±æ˜¯å¤šä¸€ä¸ªæ€è·¯ï¼<br>â€ƒâ€ƒæŠ€å¤šä¸å‹èº«ï¼<br>â€ƒâ€ƒåªè¦å­¦ä¸æ­»ï¼Œå°±å¾€æ­»é‡Œå­¦ï¼</p>
<p>ä½å­˜å‚¨<br>â€ƒâ€ƒç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ï¼Œæ´»è·ƒï¼Œä¸æ´»è·ƒï¼Œç™»å½•ï¼Œæœªç™»å½•ï¼Œæ‰“å¡ï¼Œæœªæ‰“å¡ï¼Œä¸¤ä¸ªçŠ¶æ€çš„éƒ½å¯ä»¥ç”¨Bitmapï¼<br>â€ƒâ€ƒBitmaps ä½å›¾ï¼Œæ•°æ®ç»“æ„ï¼éƒ½æ˜¯æ“ä½œäºŒè¿›åˆ¶éŸ¦æ¥è¿›è¡Œè®°å½•ï¼Œå°±åªæœ‰0å’Œ1ä¸¤ä¸ªçŠ¶æ€ï¼</p>
<p>â€ƒâ€ƒä½¿ç”¨Bitmaps æ¥è®°å½•å‘¨ä¸€åˆ°å‘¨æ—¥çš„æ‰“å¡ï¼<br>â€ƒâ€ƒå‘¨ä¸€ï¼š0<br>â€ƒâ€ƒå‘¨äºŒï¼š0</p>
<p>æŸ¥çœ‹æŸä¸€å¤©æ˜¯å¦æœ‰æ‰“å¡</p>
<p>ç»Ÿè®¡æ“ä½œï¼ŒæŸ¥çœ‹æ‰“å¡çš„å¤©æ•°<br>åªæœ‰ä¸¤å¤©æ‰“å¡</p>
<p>9ã€äº‹åŠ¡åŠç›‘æ§<br>9.1äº‹åŠ¡<br>è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ï¼ŒåŸå­æ€§ï¼</p>
<p>Redis å•æ¡å‘½ä»¤æ˜¯ä¿è¯åŸå­æ€§çš„ï¼Œä½†æ˜¯Redis äº‹åŠ¡æ˜¯ä¸ä¿è¯åŸå­æ€§çš„ï¼<br>Redis äº‹åŠ¡æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µï¼</p>
<p>æ‰€æœ‰çš„å‘½ä»¤åœ¨äº‹åŠ¡ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥è¢«æ‰§è¡Œï¼åªæœ‰å‘èµ·æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼</p>
<p>â€ƒâ€ƒRedis äº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆï¼ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ï¼Œåœ¨äº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¼šé¡ºåºæ‰§è¡Œ</p>
<p>ä¸€æ¬¡æ€§<br>é¡ºåºæ€§<br>æ’ä»–æ€§<br>æ‰§è¡Œä¸€äº›åˆ—çš„å‘½ä»¤ï¼<br>â€”â€”-é˜Ÿåˆ— set set set æ‰§è¡Œâ€”â€”â€”â€”<br>1<br>Redis çš„äº‹åŠ¡</p>
<p>å¼€å¯äº‹åŠ¡ï¼ˆmultiï¼‰<br>å‘½ä»¤å…¥åˆ—<br>æ‰§è¡Œäº‹åŠ¡ï¼ˆexecï¼‰<br>é”ï¼šredis å¯ä»¥å®ç°ä¹è§‚é”</p>
<p>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</p>
<p>127.0.0.1:6379&gt; multi #å¼€å¯äº‹åŠ¡<br>OK</p>
<h1 id="å‘½ä»¤å…¥é˜Ÿ"><a href="#å‘½ä»¤å…¥é˜Ÿ" class="headerlink" title="å‘½ä»¤å…¥é˜Ÿ"></a>å‘½ä»¤å…¥é˜Ÿ</h1><p>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; get k2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; exec #æ‰§è¡Œäº‹åŠ¡ï¼Œæ‰§è¡Œå®Œäº‹åŠ¡ç»“æŸäº†ï¼Œå¦‚æœè¿˜æƒ³æ‰§è¡Œï¼Œéœ€è¦é‡æ–°å¼€å¯äº‹åŠ¡<br>#æ‰§è¡Œäº‹åŠ¡ç»“æœ</p>
<ol>
<li>OK</li>
<li>OK</li>
<li>â€œv2â€</li>
<li>OK<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>æ”¾å¼ƒäº‹åŠ¡</li>
</ol>
<p>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k4 v4<br>QUEUED<br>127.0.0.1:6379&gt; discard #æ”¾å¼ƒäº‹åŠ¡ï¼Œä¸€æ—¦æ”¾å¼ƒï¼Œäº‹åŠ¡é˜Ÿåˆ—ä¸­å‘½ä»¤éƒ½ä¸ä¼šæ‰§è¡Œäº†<br>OK<br>127.0.0.1:6379&gt; get k4<br>(nil)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>â€ƒâ€ƒç¼–è¯‘å‹å¼‚å¸¸ï¼ˆä»£ç é—®é¢˜ï¼å‘½ä»¤æœ‰é”™ï¼‰äº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼</p>
<p>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; getset k3 #é”™è¯¯å‘½ä»¤<br>(error) ERR wrong number of arguments for â€˜getsetâ€™ command<br>127.0.0.1:6379&gt; set k4 v4<br>QUEUED<br>127.0.0.1:6379&gt; set k5 v5<br>QUEUED<br>127.0.0.1:6379&gt; exec #æ‰§è¡Œäº‹åŠ¡æŠ¥é”™çš„<br>(error) EXECABORT Transaction discarded because of previous errors.<br>127.0.0.1:6379&gt; get k5 #æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œ<br>(nil)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>â€ƒâ€ƒè¿è¡Œæ—¶å¼‚å¸¸ï¼ˆ1&#x2F;0ï¼‰,å¦‚æœäº‹åŠ¡é˜Ÿåˆ—ä¸­å­˜åœ¨è¯­æ³•æ€§ï¼Œé‚£ä¹ˆæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå…¶ä»–å‘½ä»¤æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œé”™è¯¯å‘½ä»¤æŠ›å‡ºå¼‚å¸¸ï¼</p>
<p>127.0.0.1:6379&gt; set k1 â€œv1â€ #å­˜å…¥String å€¼<br>OK<br>127.0.0.1:6379&gt; multi #å¼€å¯äº‹åŠ¡<br>OK<br>127.0.0.1:6379&gt; incr k1 #è‡ªå¢1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; get k3<br>QUEUED<br>127.0.0.1:6379&gt; exec</p>
<ol>
<li>(error) ERR value is not an integer or out of range</li>
<li>OK #è™½ç„¶ç¬¬ä¸€æ¡å‘½ä»¤æŠ¥é”™äº†ï¼Œå…¶ä»–å‘½ä»¤æ­£å¸¸æ‰§è¡Œ</li>
<li>OK</li>
<li>â€œv3â€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>9.2ç›‘æ§<br>æ‚²è§‚é”ï¼š<br>â€ƒâ€ƒå¾ˆæ‚²è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¼šå‡ºç°é—®é¢˜ï¼</li>
</ol>
<p>ä¹è§‚é”<br>â€ƒâ€ƒå¾ˆä¹è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­ä¸€ä¸‹ï¼Œåœ¨æ­¤æœŸé—´æœŸé—´æ˜¯å¦æœ‰äººä¿®æ”¹è¿‡è¿™ä¸ªæ•°æ®ï¼Œversion ï¼ï¼ˆåˆ¤æ–­versionï¼‰</p>
<p>Redis ä¹è§‚é”</p>
<p>è·å–versionï¼ˆä¸åŠ é”ï¼‰<br>æ›´æ–°çš„æ—¶å€™æ¯”è¾ƒ versionï¼Œ<br>ç¨‹åºé‡Œè¾¹å¹¶å‘çš„æ—¶å€™ä¸€èˆ¬éƒ½ä½¿ç”¨ä¹è§‚é”ï¼Œè€Œä¸ä¼šä½¿ç”¨æ‚²è§‚é”ï¼Œå› ä¸ºæ— è®ºåšä»€ä¹ˆéƒ½ä¼šåŠ é”ï¼Œæ‚²è§‚é”è¿™ä¸ªæ•ˆç‡æå…¶ä½ä¸‹ï¼Œ ä¹è§‚é”ç›¸å¯¹æ¥è¯´æ€§èƒ½ç›¸å¯¹ä¼šå¥½å¾ˆå¤šã€‚<br>Redis ç›‘è§†æµ‹è¯•</p>
<p>127.0.0.1:6379&gt; set money 100<br>OK<br>127.0.0.1:6379&gt; set out 0<br>OK<br>127.0.0.1:6379&gt; watch money #ç›‘è§†money å¯¹è±¡<br>OK<br>#äº‹åŠ¡æ­£å¸¸ç»“æŸï¼Œæ•°æ®æœŸé—´æ²¡æœ‰å‘ç”Ÿå˜åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™æ­£å¸¸æ‰§è¡ŒæˆåŠŸ<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; decrby money 20<br>QUEUED<br>127.0.0.1:6379&gt; incrby out 20<br>QUEUED<br>127.0.0.1:6379&gt; exec</p>
<ol>
<li>(integer) 80</li>
<li>(integer) 20<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>æµ‹è¯•å¤šçº¿ç¨‹ä¿®ä¿®æ”¹å€¼ï¼Œç›‘è§†ï¼Œä½¿ç”¨watchå¯ä»¥å½“åšredisçš„ä¹è§‚é”æ“ä½œ</li>
</ol>
<p>çº¿ç¨‹1</p>
<p>127.0.0.1:6379&gt; watch money #ç›‘è§†<br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; decrby money 10<br>QUEUED<br>127.0.0.1:6379&gt; incrby out 10<br>QUEUED<br>#æ‰§è¡Œä¹‹å‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å€¼ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå¯¼è‡´äº‹åŠ¡æ‰§è¡Œå¤±è´¥<br>127.0.0.1:6379&gt; exec<br>(nil)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>çº¿ç¨‹2</p>
<p>127.0.0.1:6379&gt; get money<br>(nil)<br>127.0.0.1:6379&gt; get money<br>(nil)<br>127.0.0.1:6379&gt; set money 1000<br>OK<br>1<br>2<br>3<br>4<br>5<br>6<br>å¦‚æœä¿®æ”¹å¤±è´¥ï¼Œè·å–æœ€æ–°çš„å€¼å°±å¥½ï¼</p>
<p>10ã€Jedis<br>ä»€ä¹ˆæ˜¯jedisï¼Ÿ<br>â€ƒâ€ƒæ˜¯Redis å®˜æ–¹æ¨èçš„java è¿æ¥å¼€å‘å·¥å…·ï¼ä½¿ç”¨javaæ“ä½œRedis ä¸­é—´ä»¶ï¼å¦‚æœè¦ä½¿ç”¨java æ“ä½œredis ï¼Œé‚£ä¹ˆä¸€å®šè¦å¯¹jedis ååˆ†çš„ç†Ÿæ‚‰ï¼</p>
<p>1.å¯¼å…¥ä¾èµ–</p>
<p>redis.clients jedis 3.6.0</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--fastjson--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.62<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>TEXT<br></code></pre></td></tr></table></figure>

<p>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 2.ç¼–ç æµ‹è¯• è¿æ¥æ•°æ®åº“</p>
<p>public class TestPing {<br>public static void main(String[] args) {<br>&#x2F;&#x2F;1ã€new Jedis å¯¹è±¡å³å¯<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€,6379);<br>System.out.println(jedis.ping());<br>}<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>è¾“å‡º</p>
<p>PONG<br>1<br>10.1é€šè¿‡Jedisæ“ä½œRedis<br>ping() æµ‹è¯•è¿æ¥<br>exists(â€œnameâ€) åˆ¤æ–­key æ˜¯å¦å­˜åœ¨<br>set(â€œpasswordâ€,â€xyâ€) æ ¹æ®key è®¾ç½®å€¼<br>keys(â€œ*â€) æŸ¥çœ‹æ‰€æœ‰key<br>jedis.del(â€œpasswordâ€) åˆ é™¤key<br>type(â€œusernameâ€) æŸ¥çœ‹keyçš„å­˜å‚¨æ•°æ®ç±»å‹<br>rename(â€œusernameâ€,â€nameâ€) ä¿®æ”¹key åç§°<br>select(0) æŒ‰ç´¢å¼•æŸ¥çœ‹<br>flushDB() æ¸…ç©ºå½“å‰æ•°æ®åº“<br>dbSize() è¿”å›æ•°æ®åº“ä¸­çš„keyæ•°é‡<br>flushAll() æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“key<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€, 6379);<br>System.out.println(jedis.ping());</p>
<p>System.out.println(â€œæ¸…ç©ºæ•°æ®åº“â€+jedis.flushDB());<br>System.out.println(â€œåˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨ï¼šâ€+ jedis.exists(â€œnameâ€));<br>System.out.println(â€œæ–°å¢usernameï¼Œxyé”®å€¼å¯¹ï¼šâ€+jedis.set(â€œpasswordâ€,â€xyâ€));<br>System.out.println(â€œæ–°å¢passwordï¼Œ123é”®å€¼å¯¹ï¼šâ€+jedis.set(â€œpasswordâ€,â€xyâ€));<br>System.out.println(â€œç³»ç»Ÿä¸­æ‰€æœ‰çš„key å¦‚ä¸‹ï¼šâ€);<br>Set keys &#x3D; jedis.keys(â€œ*â€);<br>System.out.println(keys);<br>System.out.println(â€œåˆ é™¤key passwordï¼šâ€+jedis.del(â€œpasswordâ€));<br>System.out.println(â€œåˆ¤æ–­key passwordæ˜¯å¦å­˜åœ¨ï¼šâ€+jedis.exists(â€œpasswordâ€));<br>System.out.println(â€œæŸ¥çœ‹key usernameæ‰€å­˜å‚¨çš„ç±»å‹ï¼šâ€+jedis.type(â€œusernameâ€));<br>System.out.println(â€œé‡å‘½åkey â€œ+jedis.rename(â€œusernameâ€,â€nameâ€));<br>System.out.println(â€œå–å‡ºä¿®æ”¹åçš„nameï¼šâ€+jedis.get(â€œnameâ€));<br>System.out.println(â€œæŒ‰ç´¢å¼•æŸ¥è¯¢ï¼šâ€+jedis.select(0));<br>System.out.println(â€œåˆ é™¤å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key ï¼šâ€+jedis.flushDB());<br>System.out.println(â€œè¿”å›æ•°æ®åº“ä¸­æ‰€æœ‰çš„key æ•°ç›®ï¼šâ€+jedis.dbSize());<br>System.out.println(â€œåˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„keyï¼šâ€+jedis.flushAll());<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>è¾“å‡ºç»“æœ</p>
<p>PONG<br>æ¸…ç©ºæ•°æ®åº“OK<br>åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨ï¼šfalse<br>æ–°å¢usernameï¼Œxyé”®å€¼å¯¹ï¼šOK<br>æ–°å¢passwordï¼Œ123é”®å€¼å¯¹ï¼šOK<br>ç³»ç»Ÿä¸­æ‰€æœ‰çš„key å¦‚ä¸‹ï¼š<br>[password, username]<br>åˆ é™¤key passwordï¼š1<br>åˆ¤æ–­key passwordæ˜¯å¦å­˜åœ¨ï¼šfalse<br>æŸ¥çœ‹key usernameæ‰€å­˜å‚¨çš„ç±»å‹ï¼šstring<br>é‡å‘½åkey OK<br>å–å‡ºä¿®æ”¹åçš„nameï¼šxy<br>æŒ‰ç´¢å¼•æŸ¥è¯¢ï¼šOK<br>åˆ é™¤å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key ï¼šOK<br>è¿”å›æ•°æ®åº“ä¸­æ‰€æœ‰çš„key æ•°ç›®ï¼š0<br>åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„keyï¼šOK<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>10.2Jedis æ“ä½œStringç±»å‹<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€, 6379);<br>&#x2F;&#x2F;æ¸…ç©ºå½“å‰æ•°æ®åº“<br>jedis.flushDB();<br>jedis.set(â€œkey1â€,â€val1â€);<br>jedis.set(â€œkey2â€,â€val2â€);<br>jedis.set(â€œkey3â€,â€val3â€);<br>System.out.println(â€œåˆ é™¤key2ï¼šâ€+jedis.del(â€œkey2â€));<br>System.out.println(â€œè·å–key2ï¼šâ€+jedis.get(â€œkey2â€));<br>System.out.println(â€œä¿®æ”¹key1ï¼šâ€+jedis.set(â€œkey1â€,â€value1Changedâ€));<br>System.out.println(â€œåœ¨key3åé¢åŠ å…¥æ•°æ®ï¼šâ€+jedis.append(â€œkey3â€,â€Emdâ€));<br>System.out.println(â€œkey3çš„å€¼ï¼šâ€+jedis.get(â€œkey3â€));<br>System.out.println(â€œå¢åŠ å¤šä¸ªé”®å€¼å¯¹ï¼šâ€+jedis.mset(â€œkey01â€,â€value01â€,â€key02â€,â€value02â€,â€key03â€,â€value03â€,â€key04â€,â€value04â€));<br>System.out.println(â€œè·å–å¤šä¸ªé”®å€¼å¯¹ï¼šâ€+jedis.mget(â€œkey01â€,â€key02â€,â€key03â€));<br>System.out.println(â€œè·å–å¤šä¸ªé”®å€¼å¯¹ï¼šâ€+jedis.mget(â€œkey01â€,â€key02â€,â€key03â€,â€key04â€));<br>System.out.println(â€œåˆ é™¤å¤šä¸ªé”®å€¼å¯¹ï¼šâ€+jedis.del(â€œkey01â€,â€key02â€));<br>System.out.println(â€œè·å–å¤šä¸ªé”®å€¼å¯¹ï¼šâ€+jedis.mget(â€œkey01â€,â€key02â€));</p>
<p>jedis.flushDB();<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;æ–°å¢é”®å€¼å¯¹å¹¶è®¾ç½®æœ‰æ•ˆæ—¶é—´&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(jedis.setnx(â€œkey1â€,â€value1â€));<br>System.out.println(jedis.setnx(â€œkey2â€,â€value2â€));<br>System.out.println(jedis.setnx(â€œkey2â€,â€value2-newâ€));<br>System.out.println(jedis.get(â€œkey1â€));<br>System.out.println(jedis.get(â€œkey2â€));</p>
<p>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;è®¾ç½®æœ‰æ•ˆæ—¶é—´&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(jedis.setex(â€œkey3â€,2,â€value3â€));<br>System.out.println(jedis.get(â€œkey3â€));</p>
<p>try{<br>TimeUnit.SECONDS.sleep(3);<br>}catch (Exception e){<br>e.printStackTrace();<br>}<br>System.out.println(jedis.get(â€œkey3â€));<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;è·å–åŸå€¼ï¼Œæ›´æ–°ä¸ºæ–°å€¼&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(jedis.getSet(â€œkey2â€,â€keyGetSetâ€));<br>System.out.println(jedis.get(â€œkey2â€));</p>
<p>System.out.println(â€œè·å¾—key2çš„å€¼çš„å­—ç¬¦ä¸²ï¼šâ€+jedis.getrange(â€œkey2â€,2,4));<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>ç»“æœï¼š</p>
<p>åˆ é™¤key2ï¼š1<br>è·å–key2ï¼šnull<br>ä¿®æ”¹key1ï¼šOK<br>åœ¨key3åé¢åŠ å…¥æ•°æ®ï¼š7<br>key3çš„å€¼ï¼šval3Emd<br>å¢åŠ å¤šä¸ªé”®å€¼å¯¹ï¼šOK<br>è·å–å¤šä¸ªé”®å€¼å¯¹ï¼š[value01, value02, value03]<br>è·å–å¤šä¸ªé”®å€¼å¯¹ï¼š[value01, value02, value03, value04]<br>åˆ é™¤å¤šä¸ªé”®å€¼å¯¹ï¼š2<br>è·å–å¤šä¸ªé”®å€¼å¯¹ï¼š[null, null]<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;æ–°å¢é”®å€¼å¯¹å¹¶è®¾ç½®æœ‰æ•ˆæ—¶é—´&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>1<br>1<br>0<br>value1<br>value2<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;è®¾ç½®æœ‰æ•ˆæ—¶é—´&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>OK<br>value3<br>null<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;è·å–åŸå€¼ï¼Œæ›´æ–°ä¸ºæ–°å€¼&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>value2<br>keyGetSet<br>è·å¾—key2çš„å€¼çš„å­—ç¬¦ä¸²ï¼šyGe<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>10.3.Jedisæ“ä½œListç±»å‹<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€, 6379);</p>
<p>jedis.flushDB();<br>System.out.println(â€œæ·»åŠ ä¸€ä¸ªListâ€);<br>jedis.lpush(â€œcollectionsâ€,â€ArrayListâ€,â€LinkedListâ€,â€Vectorâ€,â€Stackâ€,â€Mapâ€,â€HashMapâ€);<br>jedis.lpush(â€œcollectionsâ€,â€Setâ€);<br>jedis.lpush(â€œcollectionsâ€,â€HashSetâ€);<br>jedis.lpush(â€œcollectionsâ€,â€TreeMapâ€);<br>System.out.println(â€œCollectioné›†åˆå†…å®¹ï¼šâ€+jedis.lrange(â€œcollectionsâ€,0,-1));&#x2F;&#x2F;-1è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ <br>System.out.println(â€œCollectionåŒºé—´0-3çš„å…ƒç´ â€+jedis.lrange(â€œcollectionsâ€,0,3));<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>&#x2F;&#x2F;åˆ é™¤åˆ—è¡¨æŒ‡å®šçš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºåˆ é™¤çš„ä¸ªæ•°ï¼ˆæœ‰é‡å¤æ—¶ï¼‰ï¼Œåé¢addè¿›è¡Œçš„å€¼å…ˆè¢«åˆ é™¤ï¼Œç±»ä¼¼å‡ºæ ˆ<br>System.out.println(â€œåˆ é™¤æŒ‡å®šå…ƒç´ ä¸ªæ•°ï¼šâ€+jedis.lrem(â€œcollectionsâ€,2,â€HashMapâ€));<br>System.out.println(â€œcollectionså†…å®¹ï¼šâ€+jedis.lrange(â€œcollectionsâ€,0,-1));<br>System.out.println(â€œåˆ é™¤ä¸‹æ ‡0-3åŒºé—´ä¹‹å¤–çš„å…ƒç´ ï¼šâ€+jedis.ltrim(â€œcollectionsâ€,0,3));<br>System.out.println(â€œcollectionså†…å®¹ï¼šâ€+jedis.lrange(â€œcollectionsâ€,0,-1));<br>System.out.println(â€œcollectionsåˆ—è¡¨å‡ºæ ˆï¼ˆå·¦ç«¯ï¼‰ï¼šâ€+jedis.lpop(â€œcollectionsâ€));<br>System.out.println(â€œcollectionså†…å®¹ï¼šâ€+jedis.lrange(â€œcollectionsâ€,0,-1));<br>System.out.println(â€œcollectionsæ·»åŠ å…ƒç´ ï¼Œä»åˆ—è¡¨å³ç«¯ï¼Œä¸lpushå¯¹åº”â€+jedis.rpush(â€œcollectionsâ€,â€Javaâ€));<br>System.out.println(â€œcollectionså†…å®¹ï¼šâ€+jedis.lrange(â€œcollectionsâ€,0,-1));<br>System.out.println(â€œä¿®æ”¹collectionsæŒ‡å®šä¸‹æ ‡1çš„å†…å®¹ï¼šâ€+jedis.lset(â€œcollectionsâ€,1,â€newValueâ€));<br>System.out.println(â€œcollectionså†…å®¹ï¼šâ€+jedis.lrange(â€œcollectionsâ€,0,-1));<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(â€œcollectionsé•¿åº¦â€+jedis.llen(â€œcollectionsâ€));<br>System.out.println(â€œè·å–collectionsä¸‹æ ‡ä¸º2çš„é•¿åº¦â€+jedis.lindex(â€œcollectionsâ€,2));<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(jedis.lpush(â€œsortedListâ€,â€3â€,â€6â€,â€2â€,â€0â€,â€7â€,â€4â€));<br>System.out.println(â€œsortedListæ’åºå‰ï¼šâ€+jedis.lrange(â€œsortedListâ€,0,-1));<br>&#x2F;&#x2F;æ’åº<br>List sortedList &#x3D; jedis.sort(â€œsortedListâ€);<br>System.out.println(â€œsortedListæ’åºåï¼šâ€+sortedList);<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>ç»“æœ</p>
<p>æ·»åŠ ä¸€ä¸ªList<br>Collectioné›†åˆå†…å®¹ï¼š[TreeMap, HashSet, Set, HashMap, Map, Stack, Vector, LinkedList, ArrayList]<br>CollectionåŒºé—´0-3çš„å…ƒç´ [TreeMap, HashSet, Set, HashMap]<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>åˆ é™¤æŒ‡å®šå…ƒç´ ä¸ªæ•°ï¼š1<br>collectionså†…å®¹ï¼š[TreeMap, HashSet, Set, Map, Stack, Vector, LinkedList, ArrayList]<br>åˆ é™¤ä¸‹æ ‡0-3åŒºé—´ä¹‹å¤–çš„å…ƒç´ ï¼šOK<br>collectionså†…å®¹ï¼š[TreeMap, HashSet, Set, Map]<br>collectionsåˆ—è¡¨å‡ºæ ˆï¼ˆå·¦ç«¯ï¼‰ï¼šTreeMap<br>collectionså†…å®¹ï¼š[HashSet, Set, Map]<br>collectionsæ·»åŠ å…ƒç´ ï¼Œä»åˆ—è¡¨å³ç«¯ï¼Œä¸lpushå¯¹åº”4<br>collectionså†…å®¹ï¼š[HashSet, Set, Map, Java]<br>ä¿®æ”¹collectionsæŒ‡å®šä¸‹æ ‡1çš„å†…å®¹ï¼šOK<br>collectionså†…å®¹ï¼š[HashSet, newValue, Map, Java]<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>collectionsé•¿åº¦4<br>è·å–collectionsä¸‹æ ‡ä¸º2çš„é•¿åº¦Map<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>6<br>sortedListæ’åºå‰ï¼š[4, 7, 0, 2, 6, 3]<br>sortedListæ’åºåï¼š[0, 2, 3, 4, 6, 7]<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>10.4.Jedisæ“ä½œSetç±»å‹<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€, 6379);<br>jedis.flushDB();<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å¾€é›†åˆé‡Œæ·»åŠ å…ƒç´ ï¼ˆä¸é‡å¤ï¼‰&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(jedis.sadd(â€œeleSetâ€,â€e1â€,â€e2â€,â€e3â€,â€e4â€,â€e6â€,â€e5â€,â€e0â€,â€e8â€,â€e7â€));<br>System.out.println(jedis.sadd(â€œeleSetâ€,â€e6â€));<br>System.out.println(jedis.sadd(â€œeleSetâ€,â€e6â€));<br>System.out.println(â€œeleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼šâ€+jedis.smembers(â€œeleSetâ€));<br>System.out.println(â€œåˆ é™¤ä¸€ä¸ªå…ƒç´ e0:â€+jedis.srem(â€œeleSetâ€,â€e0â€));<br>System.out.println(â€œeleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼šâ€+jedis.smembers(â€œeleSetâ€));<br>System.out.println(â€œåˆ é™¤ä¸¤ä¸ªå…ƒç´ e7ï¼Œe6ï¼šâ€+jedis.srem(â€œeleSetâ€,â€e7â€,â€e6â€));<br>System.out.println(â€œeleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼šâ€+jedis.smembers(â€œeleSetâ€));<br>System.out.println(â€œéšæœºç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼šâ€+jedis.spop(â€œeleSetâ€));<br>System.out.println(â€œéšæœºç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼šâ€+jedis.spop(â€œeleSetâ€));<br>System.out.println(â€œeleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼šâ€+jedis.smembers(â€œeleSetâ€));<br>System.out.println(â€œeleSetçš„æ‰€æœ‰å…ƒç´ çš„ä¸ªæ•°ä¸ºï¼šâ€+jedis.scard(â€œeleSetâ€));<br>System.out.println(â€œe3æ˜¯å¦åœ¨eleSetä¸­ï¼šâ€+jedis.sismember(â€œeleSetâ€,â€e3â€));<br>System.out.println(â€œe1æ˜¯å¦åœ¨eleSetä¸­ï¼šâ€+jedis.sismember(â€œeleSetâ€,â€e1â€));<br>System.out.println(â€œe5æ˜¯å¦åœ¨eleSetä¸­ï¼šâ€+jedis.sismember(â€œeleSetâ€,â€e5â€));<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(jedis.sadd(â€œeleSet1â€,â€e1â€,â€e2â€,â€e3â€,â€e4â€,â€e5â€,â€e8â€,â€e7â€));<br>System.out.println(jedis.sadd(â€œeleSet2â€,â€e1â€,â€e2â€,â€e3â€,â€e4â€,â€e8â€));<br>System.out.println(â€œå°†eleSet1ä¸­åˆ é™¤e1å¹¶å­˜å…¥eleSet3ä¸­ï¼šâ€+jedis.smove(â€œeleSet1â€,â€eleSet3â€,â€e1â€));<br>System.out.println(â€œå°†eleSet2ä¸­åˆ é™¤e1å¹¶å­˜å…¥eleSet3ä¸­ï¼šâ€+jedis.smove(â€œeleSet1â€,â€eleSet3â€,â€e2â€));<br>System.out.println(â€œeleSet1ä¸­çš„å…ƒç´ ï¼šâ€+jedis.smembers(â€œeleSet1â€));<br>System.out.println(â€œeleSet3ä¸­çš„å…ƒç´ ï¼šâ€+jedis.smembers(â€œeleSet3â€));<br>System.out.println(â€œ&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;é›†åˆè¿ç®—&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;â€);<br>System.out.println(â€œeleSet1ä¸­çš„å…ƒç´ ï¼šâ€+jedis.smembers(â€œeleSet1â€));<br>System.out.println(â€œeleSet2ä¸­çš„å…ƒç´ ï¼šâ€+jedis.smembers(â€œeleSet2â€));<br>System.out.println(â€œeleSet1å’ŒeleSet2çš„å¹¶é›†ï¼šâ€+jedis.sinter(â€œeleSet1â€,â€eleSet2â€));<br>System.out.println(â€œeleSet1å’ŒeleSet2çš„å¹¶é›†ï¼šâ€+jedis.sunion(â€œeleSet1â€,â€eleSet2â€));<br>System.out.println(â€œeleSet1å’ŒeleSet2çš„å·®é›†ï¼šâ€+jedis.sdiff(â€œeleSet1â€,â€eleSet2â€));<br>&#x2F;&#x2F;æ±‚å¹¶é›†å¹¶å°†äº¤é›†ä¿å­˜åˆ°dstkeyé›†åˆ<br>jedis.sinterstore(â€œeleSet4â€,â€eleSet1â€,â€eleSet2â€);<br>System.out.println(â€œeleSet4çš„å…ƒç´ ï¼šâ€+jedis.smembers(â€œeleSet4â€));<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>ç»“æœ</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;å¾€é›†åˆé‡Œæ·»åŠ å…ƒç´ ï¼ˆä¸é‡å¤ï¼‰&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>9<br>0<br>0<br>eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š[e1, e2, e4, e6, e0, e5, e7, e3, e8]<br>åˆ é™¤ä¸€ä¸ªå…ƒç´ e0:1<br>eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š[e6, e5, e4, e1, e7, e3, e8, e2]<br>åˆ é™¤ä¸¤ä¸ªå…ƒç´ e7ï¼Œe6ï¼š2<br>eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š[e4, e1, e5, e3, e8, e2]<br>éšæœºç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼še3<br>éšæœºç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼še4<br>eleSetçš„æ‰€æœ‰å…ƒç´ ä¸ºï¼š[e1, e5, e8, e2]<br>eleSetçš„æ‰€æœ‰å…ƒç´ çš„ä¸ªæ•°ä¸ºï¼š4<br>e3æ˜¯å¦åœ¨eleSetä¸­ï¼šfalse<br>e1æ˜¯å¦åœ¨eleSetä¸­ï¼štrue<br>e5æ˜¯å¦åœ¨eleSetä¸­ï¼štrue<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>7<br>5<br>å°†eleSet1ä¸­åˆ é™¤e1å¹¶å­˜å…¥eleSet3ä¸­ï¼š1<br>å°†eleSet2ä¸­åˆ é™¤e1å¹¶å­˜å…¥eleSet3ä¸­ï¼š1<br>eleSet1ä¸­çš„å…ƒç´ ï¼š[e3, e8, e4, e7, e5]<br>eleSet3ä¸­çš„å…ƒç´ ï¼š[e2, e1]<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;é›†åˆè¿ç®—&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>eleSet1ä¸­çš„å…ƒç´ ï¼š[e3, e8, e4, e7, e5]<br>eleSet2ä¸­çš„å…ƒç´ ï¼š[e4, e3, e2, e1, e8]<br>eleSet1å’ŒeleSet2çš„å¹¶é›†ï¼š[e4, e3, e8]<br>eleSet1å’ŒeleSet2çš„å¹¶é›†ï¼š[e3, e8, e1, e2, e4, e7, e5]<br>eleSet1å’ŒeleSet2çš„å·®é›†ï¼š[e5, e7]<br>eleSet4çš„å…ƒç´ ï¼š[e4, e3, e8]<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>10.5.Jedisæ“ä½œHash<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€, 6379);</p>
<p>jedis.flushDB();<br>Map&lt;String,String&gt; hash &#x3D; new HashMap&lt;String, String&gt;();<br>hash.put(â€œk1â€,â€v1â€);<br>hash.put(â€œk2â€,â€v2â€);<br>hash.put(â€œk3â€,â€v3â€);<br>hash.put(â€œk4â€,â€v4â€);<br>&#x2F;&#x2F;æ·»åŠ åç§°ä¸ºhashï¼ˆkeyï¼‰çš„å…ƒç´ <br>jedis.hmset(â€œhashâ€,hash);<br>&#x2F;&#x2F;å‘åç§°ä¸ºhashçš„hashä¸­æ·»åŠ key k5 value ä¸ºv5<br>jedis.hset(â€œhashâ€,â€k5â€,â€v5â€);<br>System.out.println(â€œæ•£åˆ—hashçš„æ‰€æœ‰é”®å€¼å¯¹ä¸ºï¼šâ€+jedis.hgetAll(â€œhashâ€));<br>System.out.println(â€œæ•£åˆ—hashçš„æ‰€æœ‰é”®ï¼šâ€+jedis.hkeys(â€œhashâ€));<br>System.out.println(â€œæ•£åˆ—hashçš„æ‰€æœ‰å€¼ï¼šâ€+jedis.hvals(â€œhashâ€));<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>ç»“æœ</p>
<p>æ•£åˆ—hashçš„æ‰€æœ‰é”®å€¼å¯¹ä¸ºï¼š{k3&#x3D;v3, k4&#x3D;v4, k5&#x3D;v5, k1&#x3D;v1, k2&#x3D;v2}<br>æ•£åˆ—hashçš„æ‰€æœ‰é”®ï¼š[k3, k4, k5, k1, k2]<br>æ•£åˆ—hashçš„æ‰€æœ‰å€¼ï¼š[v3, v2, v1, v4, v5]<br>1<br>2<br>3<br>10.6Jedisæ“ä½œäº‹åŠ¡<br>public static void main(String[] args) {<br>Jedis jedis &#x3D; new Jedis(â€œ127.0.0.1â€, 6379);<br>jedis.flushDB();<br>&#x2F;&#x2F;å¼€å¯äº‹åŠ¡<br>Transaction transaction &#x3D; jedis.multi();<br>JSONObject jsonObject &#x3D; new JSONObject();<br>jsonObject.put(â€œhelloâ€, â€œworldâ€);<br>jsonObject.put(â€œnameâ€, â€œxyâ€);<br>String result &#x3D; jsonObject.toJSONString();</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">try &#123;<br>    <span class="hljs-keyword">transaction</span>.<span class="hljs-keyword">set</span>(&quot;user1&quot;, result);<br>    <span class="hljs-keyword">transaction</span>.<span class="hljs-keyword">set</span>(&quot;user2&quot;, result);<br><br>    //æ¨¡æ‹Ÿå¼‚å¸¸<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">1</span> /<span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">transaction</span>.exec();<br>&#125; catch (<span class="hljs-keyword">Exception</span> e) &#123;<br>    //æ”¾å¼ƒäº‹åŠ¡<br>    <span class="hljs-keyword">transaction</span>.<span class="hljs-keyword">discard</span>();<br>    e.printStackTrace();<br>&#125;finally&#123;<br>    <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(jedis.<span class="hljs-keyword">get</span>(&quot;user1&quot;));<br>    <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(jedis.<span class="hljs-keyword">get</span>(&quot;user2&quot;));<br>    jedis.<span class="hljs-keyword">close</span>();//å…³é—­è¿æ¥<br>&#125;<br><br><span class="hljs-type">TEXT</span><br></code></pre></td></tr></table></figure>

<p>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>ç»“æœï¼š</p>
<p>java.lang.ArithmeticException: &#x2F; by zero<br>at cn.bloghut.TestTx.main(TestTx.java:30)<br>null<br>null<br>1<br>2<br>3<br>4<br>11ã€SpringBooté›†æˆRedis<br>11.1SpringBooté›†æˆRedisæºç <br>SpringBoot æ“ä½œæ•°æ®åº“ï¼šspring-data jpa jdbc mongodb redis</p>
<p>Spring Dataä¹Ÿæ˜¯å’ŒSpringBoot é½åçš„é¡¹ç›®</p>
<p>åœ¨SpringBoot 2.xä¹‹åï¼ŒåŸæ¥ä½¿ç”¨çš„jedis è¢«æ›¿æ¢æˆäº† lettuce</p>
<p>jedisï¼š<br>â€ƒâ€ƒåº•å±‚é‡‡ç”¨çš„æ˜¯ç›´è¿ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œçš„è¯æ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœæƒ³è¦é¿å…ä¸å®‰å…¨ï¼Œä½¿ç”¨jedis poolè¿æ¥æ± ï¼ NIOæ¨¡å¼</p>
<p>lettuceï¼š<br>â€ƒâ€ƒåº•å±‚é‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­è¿›è¡Œå…±äº«ï¼Œä¸å­˜åœ¨ä¸å®‰å…¨çš„æƒ…å†µï¼å¯ä»¥å‡å°‘çº¿ç¨‹æ•°é‡ï¼Œæ›´æ–° NIO æ¨¡å¼</p>
<p>spring.factories</p>
<p>RedisTemplate æ¨¡æ¿</p>
<p>@ConditionalOnMissingBeanï¼Œå®ƒæ˜¯ä¿®é¥°beançš„ä¸€ä¸ªæ³¨è§£ï¼Œä¸»è¦å®ç°çš„æ˜¯ï¼Œå½“ä½ çš„beanè¢«æ³¨å†Œä¹‹åï¼Œå¦‚æœè€Œæ³¨å†Œç›¸åŒç±»å‹çš„beanï¼Œå°±ä¸ä¼šæˆåŠŸï¼Œå®ƒä¼šä¿è¯ä½ çš„beanåªæœ‰ä¸€ä¸ªï¼Œå³ä½ çš„å®ä¾‹åªæœ‰ä¸€ä¸ªï¼Œå½“ä½ æ³¨å†Œå¤šä¸ªç›¸åŒçš„beanæ—¶ï¼Œä¼šå‡ºç°å¼‚å¸¸ï¼Œä»¥æ­¤æ¥å‘Šè¯‰å¼€å‘äººå‘˜ã€‚<br>ç®€å•ç‚¹ï¼šå°±æ˜¯ä¸å­˜åœ¨è¿™ä¸ªbean è¿™ä¸ªæ–¹æ³•æ‰ç”Ÿæ•ˆï¼<br>æˆ‘ä»¬å¦‚æœè‡ªå·±å®šä¹‰äº†ä¸€ä¸ªredisTemplate å®ƒè¿™ä¸ªé»˜è®¤çš„å°±ä¼šå¤±æ•ˆ</p>
<p>@Bean<br>@ConditionalOnMissingBean<br>@ConditionalOnSingleCandidate(RedisConnectionFactory.class)<br>public StringRedisTemplate stringRedisTemplate(RedisConnectionFactory redisConnectionFactory) {<br>1<br>2<br>3<br>4<br>ç”±äº String æ˜¯redisä¸­æœ€å¸¸ç”¨çš„ç±»å‹ï¼Œæ‰€ä»¥å•ç‹¬æå‡ºæ¥ä¸€ä¸ªbean</p>
<p>11.2SpringBootæ•´åˆRedis<br>1.å¯¼å…¥ä¾èµ–</p>
<p>org.springframework.boot spring-boot-starter-data-redis </p>
<p>1 2 3 4 2.é…ç½®è¿æ¥</p>
<p>#SpringBoot æ‰€æœ‰çš„é…ç½®ç±»éƒ½æœ‰ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»<br>#è‡ªåŠ¨é…ç½®ç±» éƒ½ä¼šç»‘å®šä¸€ä¸ªproperties é…ç½®æ–‡ä»¶</p>
<p>spring:<br>redis:<br>host: 127.0.0.1<br>port: 6379<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>3.æµ‹è¯•</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs awk">@Autowired<br>private RedisTemplate redisTemplate;<br><br>@Test<br>void contextLoads() &#123;<br>    <span class="hljs-regexp">//</span>æ“ä½œä¸åŒçš„æ•°æ®ç±»å‹<br>    <span class="hljs-regexp">//</span>æ“ä½œäº”å¤§æ•°æ®ç±»å‹<br>    <span class="hljs-regexp">//</span>opsForValue()    æ“ä½œString<br>    <span class="hljs-regexp">//</span>opsForList()     æ“ä½œList<br>    <span class="hljs-regexp">//</span>opsForSet()      æ“ä½œSet<br>    <span class="hljs-regexp">//</span>opsForHash()     æ“ä½œHash<br>    <span class="hljs-regexp">//</span>opsForZSet()     æ“ä½œZset<br><br>    <span class="hljs-regexp">//</span>é™¤äº†åŸºæœ¬æ“ä½œï¼Œå¸¸ç”¨æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨<br>    <span class="hljs-regexp">//</span>äº‹åŠ¡ å’ŒåŸºæœ¬çš„CRUD<br><br>    <span class="hljs-regexp">//</span>è·å–redis è¿æ¥å¯¹è±¡<br><br>TEXT<br></code></pre></td></tr></table></figure>

<p>&#x2F;&#x2F; RedisConnection connection &#x3D; redisTemplate.getConnectionFactory().getConnection();<br>&#x2F;&#x2F; connection.flushDb();<br>&#x2F;&#x2F; connection.flushAll();</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">    redisTemplate.opsForValue().<span class="hljs-keyword">set</span>(&quot;mykey&quot;,&quot;csdn_xy&quot;);<br>    <span class="hljs-keyword">Object</span> mykey = redisTemplate.opsForValue().<span class="hljs-keyword">get</span>(&quot;mykey&quot;);<br>    <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(mykey);<br><br><br>&#125;<br><br><span class="hljs-type">TEXT</span><br></code></pre></td></tr></table></figure>

<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>â€ƒâ€ƒæ‰€æœ‰çš„redisæ“ä½œï¼Œå…¶å®å¯¹äºjavaå¼€å‘äººå‘˜æ¥è¯´ï¼Œååˆ†çš„ç®€å•ï¼Œæ›´é‡è¦æ˜¯è¦å»ç†è§£redisçš„æ€æƒ³å’Œæ¯ä¸€ç§ æ®ç»“æ„çš„ç”¨å¤„å’Œä½œç”¨åœºæ™¯ï¼</p>
<p>11.3è‡ªå®šä¹‰RedisTemplate<br>1.RedisTemplateä½¿ç”¨çš„æ˜¯ JdkSerializationRedisSerializer<br>2.RedisTemplate å°è£…äº†å¯¹Redisçš„ä¸€äº›å¸¸ç”¨çš„æ“ä½œ<br>3.Jedisæ˜¯Rediså®˜æ–¹æ¨èçš„é¢å‘Javaçš„æ“ä½œRedisçš„å®¢æˆ·ç«¯ï¼Œè€ŒRedisTemplateæ˜¯SpringDataRedisä¸­å¯¹JedisApiçš„é«˜åº¦å°è£…ã€‚</p>
<p>@Configuration<br>public class RedisConfig {</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è‡ªå·±å®šä¹‰äº†ä¸€ä¸ª RedisTemplate</span><br><span class="hljs-comment"> * @param factory</span><br><span class="hljs-comment"> * @return</span><br><span class="hljs-comment"> */</span><br>@Bean<br>@<span class="hljs-built_in">SuppressWarnings</span>(<span class="hljs-string">&quot;all&quot;</span>)<br><span class="hljs-function"><span class="hljs-keyword">public</span> RedisTemplate&lt;<span class="hljs-type">String</span>, Object&gt; <span class="hljs-title">redisTemplate</span><span class="hljs-params">(RedisConnectionFactory</span></span><br><span class="hljs-params"><span class="hljs-function">                                                           factory)</span> </span>&#123;<br>    <span class="hljs-comment">// æˆ‘ä»¬ä¸ºäº†è‡ªå·±å¼€å‘æ–¹ä¾¿ï¼Œä¸€èˆ¬ç›´æ¥ä½¿ç”¨ &lt;String, Object&gt;</span><br>    RedisTemplate&lt;<span class="hljs-type">String</span>, Object&gt; <span class="hljs-keyword">template</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RedisTemplate</span>&lt;<span class="hljs-type">String</span>,<br>            Object&gt;();<br>    <span class="hljs-keyword">template</span>.<span class="hljs-built_in">setConnectionFactory</span>(factory);<br>    <span class="hljs-comment">// Jsonåºåˆ—åŒ–é…ç½®</span><br>    Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="hljs-keyword">new</span><br>            <span class="hljs-built_in">Jackson2JsonRedisSerializer</span>(Object.<span class="hljs-keyword">class</span>);<br>    ObjectMapper om = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ObjectMapper</span>();<br>    om.<span class="hljs-built_in">setVisibility</span>(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);<br>    om.<span class="hljs-built_in">enableDefaultTyping</span>(ObjectMapper.DefaultTyping.NON_FINAL);<br>    jackson2JsonRedisSerializer.<span class="hljs-built_in">setObjectMapper</span>(om);<br>    <span class="hljs-comment">// String çš„åºåˆ—åŒ–</span><br>    StringRedisSerializer stringRedisSerializer = <span class="hljs-keyword">new</span><br>            <span class="hljs-built_in">StringRedisSerializer</span>();<br>    <span class="hljs-comment">// keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span><br>    <span class="hljs-keyword">template</span>.<span class="hljs-built_in">setKeySerializer</span>(stringRedisSerializer);<br>    <span class="hljs-comment">// hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span><br>    <span class="hljs-keyword">template</span>.<span class="hljs-built_in">setHashKeySerializer</span>(stringRedisSerializer);<br>    <span class="hljs-comment">// valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span><br>    <span class="hljs-keyword">template</span>.<span class="hljs-built_in">setValueSerializer</span>(jackson2JsonRedisSerializer);<br>    <span class="hljs-comment">// hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span><br>    <span class="hljs-keyword">template</span>.<span class="hljs-built_in">setHashValueSerializer</span>(jackson2JsonRedisSerializer);<br>    <span class="hljs-keyword">template</span>.<span class="hljs-built_in">afterPropertiesSet</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">template</span>;<br>&#125;<br><br>TEXT<br></code></pre></td></tr></table></figure>

<p>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>12ã€Redis.confé…ç½®æ–‡ä»¶è¯¦è§£<br>â€ƒâ€ƒ1.å¯åŠ¨çš„æ—¶å€™é€šè¿‡é…ç½®æ–‡ä»¶æ¥å¯åŠ¨ï¼<br>â€ƒâ€ƒ2.è¡Œå®¶æœ‰æ²¡æœ‰ï¼Œå‡ºæ‰‹å°±çŸ¥é“<br>â€ƒâ€ƒ3.è¡Œå®¶ä¸€å‡ºæ‰‹ï¼Œå°±çŸ¥æœ‰æ²¡æœ‰<br>â€ƒâ€ƒ4.å†…è¡Œçœ‹é—¨é“ï¼Œå¤–è¡Œçœ‹çƒ­é—¹<br>â€ƒâ€ƒ5.å·¥ä½œä¸­ä¸€äº›å°å°çš„é…ç½®ï¼Œå¯ä»¥è®©ä½ è„±é¢–è€Œå‡º</p>
<p>unitå•ä½ å¯¹å¤§å°å†™ä¸æ•æ„Ÿ</p>
<p>åŒ…å«<br>æ¯”å¦‚Spring é‡Œé¢ çš„import</p>
<p>ç½‘ç»œ</p>
<p>ç»‘å®šçš„ip bind 127.0.0.1 -::1<br>ä¿æŠ¤æ¨¡å¼ protected-mode yes<br>ç«¯å£å· port 6379<br>1<br>2<br>3<br>é€šç”¨é…ç½®<br>æ˜¯å¦ä»¥å®ˆæŠ¤çº¿ç¨‹å¼€å¯ï¼Œé»˜è®¤æ˜¯no yes ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ</p>
<p>å¦‚ä½•ä»¥åå°çš„æ–¹å¼è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šä¸€ä¸ªpid æ–‡ä»¶ï¼ˆè¿›ç¨‹æ–‡ä»¶ï¼‰</p>
<p>æ—¥å¿—</p>
<p>æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯16ä¸ª</p>
<p>æ˜¯å¦æ˜¾ç¤ºlogo</p>
<p>å¿«ç…§<br>æŒä¹…åŒ–ï¼Œåœ¨è§„å®šçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡æ“ä½œï¼Œåˆ™ä¼šæŒä¹…åŒ–åˆ° .rdb ã€‚aof</p>
<p>redis æ˜¯ä¸ªå†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸æŒä¹…åŒ–çš„è¯ï¼Œæ•°æ®å°±ä¼šä¸¢</p>
<p>å†…å­˜æ˜¯ æ–­ç”µå³å¤±å»</p>
<p>save 900 1</p>
<p>å¦‚æœ900 ç§’å†…ï¼Œå¦‚æœè‡³å°‘æœ‰1ä¸ªkey è¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å…¶è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</p>
<p>save 30 10</p>
<p>å¦‚æœ300 ç§’å†…ï¼Œå¦‚æœè‡³å°‘æœ‰10ä¸ªkey è¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å…¶è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</p>
<p>save 60 10000</p>
<p>å¦‚æœ60 ç§’å†…ï¼Œå¦‚æœè‡³å°‘æœ‰10000ä¸ªkey è¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å…¶è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</p>
<p>æŒä¹…åŒ–å¤±è´¥äº†ï¼Œæ˜¯å¦ç»§ç»­æ‰§è¡Œå·¥ä½œ</p>
<p>æ˜¯å¦å‹ç¼©rdb æ–‡ä»¶ï¼ˆrdb æŒä¹…åŒ–çš„æ–‡ä»¶ï¼‰,éœ€è¦è€—è´¹ä¸€äº›CPUçš„èµ„æºï¼</p>
<p>ä¿å­˜rdbæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿›è¡Œrdbæ£€æŸ¥æ ¡éªŒ</p>
<p>rdbæ–‡ä»¶ä¿å­˜çš„ç›®å½•</p>
<p>ä¸»ä»å¤åˆ¶ç›¸å…³çš„</p>
<p>æ˜¯ä¸æ˜¯ä¿å­˜ä¸€äº›æ•°æ®</p>
<p>æ˜¯ä¸æ˜¯åªè¯»çš„</p>
<p>å®‰å…¨ç›¸å…³</p>
<p>å¯ä»¥è®¾ç½®å¯†ç ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç çš„</p>
<p>æ²¡æœ‰æƒé™ï¼Œéœ€è¦ç™»å½•</p>
<p>è®¾ç½®å¯†ç </p>
<p>å®¢æˆ·ç«¯é™åˆ¶<br>maxclients 1000 è®¾ç½®èƒ½è¿æ¥ä¸Šredis çš„æœ€å¤§å®¢æˆ·ç«¯æ•°é‡</p>
<p>å†…å­˜åˆ°è¾¾ä¸Šé™çš„å¤„ç†ç­–ç•¥<br>ç§»é™¤ä¸€äº›è¿‡æœŸçš„key<br>æŠ¥é”™<br>â€ƒâ€ƒ1ã€volatile-lruï¼šåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¿›è¡ŒLRUï¼ˆé»˜è®¤å€¼ï¼‰<br>â€ƒâ€ƒ2ã€allkeys-lru ï¼š åˆ é™¤lruç®—æ³•çš„key<br>â€ƒâ€ƒ3ã€volatile-randomï¼šéšæœºåˆ é™¤å³å°†è¿‡æœŸkey<br>â€ƒâ€ƒ4ã€allkeys-randomï¼šéšæœºåˆ é™¤<br>â€ƒâ€ƒ5ã€volatile-ttl ï¼š åˆ é™¤å³å°†è¿‡æœŸçš„<br>â€ƒâ€ƒ6ã€noeviction ï¼š æ°¸ä¸è¿‡æœŸï¼Œè¿”å›é”™è¯¯</p>
<p>AOFé…ç½®</p>
<p>â€ƒâ€ƒé»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œæ¨¡å¼æ˜¯ä½¿ç”¨rdb æ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œrdbå®Œå…¨å¤Ÿç”¨äº†ï¼<br>appendonly.aof æŒä¹…åŒ–æ–‡ä»¶çš„åç§°</p>
<p>â€ƒâ€ƒ1.appendfsync everysec æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync ï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®<br>â€ƒâ€ƒ2.appendfsync always æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncï¼Œé€Ÿåº¦æ¯”è¾ƒæ…¢<br>â€ƒâ€ƒ3.appendfsync no ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</p>
<p>æ€§èƒ½å»ºè®®è¿˜æ˜¯ é¦–é€‰rdb</p>
<p>13ã€RedisæŒä¹…åŒ–<br>RedisæŒä¹…åŒ–â€“ADB<br>é¢è¯•å’Œå·¥ä½œï¼ŒæŒä¹…åŒ–éƒ½æ˜¯é‡ç‚¹ã€‚</p>
<p>â€ƒâ€ƒRedis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸å°†å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜ï¼Œé‚£ä¹ˆä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼ˆæ–­ç”µï¼‰ï¼ŒæœåŠ¡å™¨ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¹Ÿä¼šæ¶ˆå¤±ã€‚æ‰€ä»¥Redis æä¾›äº†æŒä¹…åŒ–åŠŸèƒ½ã€‚</p>
<p>åœ¨ä¸»ä»å¤åˆ¶ä¸­ï¼Œrdb æ˜¯ç”¨äºå¤‡ç”¨çš„</p>
<p>â€ƒâ€ƒåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œè¡Œè¯å°†çš„ï¼šSnapshot å¿«ç…§ï¼Œå®ƒæ¢å¤æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚</p>
<p>â€ƒâ€ƒRedusä¼šå•ç‹¬åˆ›å»ºï¼ˆForkï¼‰ ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›ç¨‹æŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IO æ“ä½œçš„ã€‚è¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹å¼è¦æ¯”AOF æ–¹å¼æ›´åŠ çš„é«˜æ•ˆï¼ŒRDB ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®åº“å¯èƒ½ä¸¢å¤±ã€‚æˆ‘ä»¬é»˜è®¤çš„å°±æ˜¯RDBï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹è¿™ä¸ªé…ç½®ã€‚</p>
<p>â€ƒâ€ƒRDBä¿å­˜çš„æ–‡ä»¶æ˜¯dump.rbb</p>
<p>â€ƒâ€ƒéƒ½æ˜¯åœ¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ä¸­å¿«ç…§ä¸­è¿›è¡Œé…ç½®çš„</p>
<p>ä¸€åˆ†é’Ÿç±» æ·»åŠ 5ä¸ªkey</p>
<p>ç”Ÿæˆäº†dump.rdb</p>
<p>å…³æœº</p>
<p>æŸ¥çœ‹è¿›ç¨‹<br>å·²ç»å…³é—­äº†</p>
<p>å¯åŠ¨redis</p>
<p>æŸ¥çœ‹è¿›ç¨‹</p>
<p>è¿æ¥<br>è·å–k1<br>å¯ä»¥è·å–åˆ°å…¶å€¼ v1 ä¸€ç›´å­˜åœ¨</p>
<p>ä½¿ç”¨flushall å‘½ä»¤ï¼Œæ¸…ç©ºæ‰€æœ‰æ•°æ®åº“ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªrdbæ–‡ä»¶</p>
<p>è§¦å‘æœºåˆ¶</p>
<p>save çš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbè§„åˆ™<br>æ‰§è¡Œflushall å‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘rdbè§„åˆ™<br>é€€å‡ºredis ï¼Œä¹Ÿä¼šäº§ç”Ÿrdbæ–‡ä»¶ï¼<br>å¤‡ä»½å°±ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªdump.rdb æ–‡ä»¶</p>
<p>å¦‚ä½•æ¢å¤rdbæ–‡ä»¶</p>
<p>åªéœ€è¦å°†rdbæ–‡ä»¶æ”¾åœ¨æˆ‘ä»¬rediså¯åŠ¨å°±å¯ä»¥äº†ï¼ŒRedis å¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ£€æŸ¥dump.rdbæ–‡ä»¶ æ¢å¤å…¶ä¸­çš„æ•°æ®ã€‚<br>æŸ¥çœ‹éœ€è¦å­˜æ”¾çš„æ–‡å­—<br>å¦‚æœåœ¨ è¿™ä¸ª &#x2F;home&#x2F;wrz&#x2F;redis-6.2.3&#x2F;src ç›®å½•ä¸‹å­˜æ”¾ dump.rdbæ–‡ä»¶ï¼Œå¯åŠ¨å°±ä¼šè‡ªåŠ¨æ¢å¤å…¶ä¸­çš„æ•°æ®ã€‚</p>
<p>å‡ ä¹ä»–è‡ªå·±é»˜è®¤çš„é…ç½®å°±å¤Ÿç”¨äº†ï¼</p>
<p>ä¼˜ç‚¹</p>
<p>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤ï¼<br>å¯¹æ•°æ®çš„å®Œæ•´æ€§è¦æ±‚ä¸é«˜ï¼<br>ç¼ºç‚¹</p>
<p>éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›ç¨‹æ“ä½œï¼å¦‚æœæ„å¤–å®•æœºäº†ï¼Œè¿™ä¸ªæœ€åä¸€æ¬¡ä¿®æ”¹æ•°æ®å°±æ²¡æœ‰çš„äº†ï¼<br>forkè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå ç”¨ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼<br>RedisæŒä¹…åŒ–â€“AOF<br>â€ƒâ€ƒå°†æˆ‘ä»¬çš„æ‰€æœ‰å‘½ä»¤éƒ½è®°å½•ä¸‹æ¥ï¼Œhistoryï¼Œæ¢å¤çš„æ—¶å€™æŠŠè¿™ä¸ªæ–‡ä»¶å…¨éƒ¨å†æ‰§è¡Œä¸€é</p>
<p>â€ƒâ€ƒä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼ŒRedis å¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ</p>
<p>â€ƒâ€ƒAOFä¿å­˜çš„æ˜¯appendonly.aof æ–‡ä»¶</p>
<p>é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®ï¼Œå°†appendonly è®¾ç½®ä¸ºyes</p>
<p>é‡å†™çš„è§„åˆ™</p>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<p>é‡å¯redis</p>
<p>æŸ¥çœ‹aofæ–‡ä»¶</p>
<p>æ·»åŠ æ•°æ®</p>
<p>æŸ¥çœ‹appendonly æ–‡ä»¶</p>
<p>â€ƒâ€ƒå¦‚æœè¿™ä¸ªaof æ–‡ä»¶æœ‰é”™ä½ï¼Œè¿™ä¸ªæ—¶å€™redisæ˜¯å¯åŠ¨ä¸èµ·æ¥çš„ï¼Œéœ€è¦ä¿®å¤è¿™ä¸ªaof æ–‡ä»¶<br>redis æä¾›äº†ä¸€ä¸ªå·¥å…·</p>
<p>redis-check-aof â€“fix<br>1<br>ä¸€ç§æ˜¯å…¨ä¸¢ï¼Œåªä¸¢é”™è¯¯çš„æ•°æ®ã€‚</p>
<p>appendfsync everysec æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync ï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®<br>appendfsync always æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncï¼Œé€Ÿåº¦æ¯”è¾ƒæ…¢<br>appendfsync no ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼<br>ä¼˜ç‚¹</p>
<p>æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½åŒæ­¥ï¼Œæ–‡ä»¶å®Œæ•´æ€§æ›´åŠ å¥½ï¼<br>æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’çš„æ•°æ®<br>ä»ä¸åŒæ­¥ï¼Œæ•ˆç‡æœ€é«˜ï¼<br>ç¼ºç‚¹</p>
<p>æ•°æ®æ–‡ä»¶æ¥è¯´ï¼Œaof è¿œè¿œå¤§äºrdbï¼Œä¿®æ”¹çš„é€Ÿåº¦ä¹Ÿæ¯”rdbæ…¢ï¼<br>aof è¿è¡Œæ•ˆç‡ä¹Ÿè¦æ¯”rdbæ…¢ï¼Œæ‰€æœ‰redis é»˜è®¤é…ç½®æ˜¯rdb æŒä¹…åŒ–ã€‚<br>é‡å†™è§„åˆ™è¯´æ˜</p>
<p>é»˜è®¤å°±æ˜¯æ–‡ä»¶çš„æ— é™è¿½åŠ ï¼Œæ–‡ä»¶è¶Šæ¥è¶Šå¤§<br>å¦‚æœaof æ–‡ä»¶å¤§äº64m ï¼Œå¤ªå¤§äº†ï¼fork ä¸€ä¸ªæ–°çš„è¿›æ¥å¸®æˆ‘ä»¬çš„æ–‡ä»¶è¿›è¡Œé‡å†™ï¼</p>
<p>RedisæŒä¹…åŒ–æ€»ç»“<br>RDB æŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨<br>AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œï¼Œå½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹ çš„æ•°æ®ï¼ŒAOFå‘½ä»¤ä»¥Redis åè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾ï¼ŒRedisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡ å†™ï¼Œä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§ã€‚<br>åªåšç¼“å­˜ï¼Œå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–<br>åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼<br>â€ƒâ€ƒåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOF æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚<br>â€ƒâ€ƒRDB çš„æ•°æ®ä¸å®æ—¶ï¼ŒåŒæ—¶ä½¿ç”¨ä¸¤è€…æ—¶æœåŠ¡å™¨é‡å¯ä¹Ÿåªä¼šæ‰¾AOFæ–‡ä»¶ï¼Œé‚£è¦ä¸è¦åªä½¿ç”¨AOFå‘¢ï¼Ÿä½œè€… å»ºè®®ä¸è¦ï¼Œå› ä¸ºRDBæ›´é€‚åˆç”¨äºå¤‡ä»½æ•°æ®åº“ï¼ˆAOFåœ¨ä¸æ–­å˜åŒ–ä¸å¥½å¤‡ä»½ï¼‰ï¼Œå¿«é€Ÿé‡å¯ï¼Œè€Œä¸”ä¸ä¼šæœ‰ AOFå¯èƒ½æ½œåœ¨çš„Bugï¼Œç•™ç€ä½œä¸ºä¸€ä¸ªä¸‡ä¸€çš„æ‰‹æ®µã€‚<br>æ€§èƒ½å»ºè®®<br>â€ƒâ€ƒå› ä¸ºRDBæ–‡ä»¶åªç”¨ä½œåå¤‡ç”¨é€”ï¼Œå»ºè®®åªåœ¨Slaveä¸ŠæŒä¹…åŒ–RDBæ–‡ä»¶ï¼Œè€Œä¸”åªè¦15åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡å°±å¤Ÿ äº†ï¼Œåªä¿ç•™ save 900 1 è¿™æ¡è§„åˆ™ã€‚<br>â€ƒâ€ƒ å¦‚æœEnable AOF ï¼Œå¥½å¤„æ˜¯åœ¨æœ€æ¶åŠ£æƒ…å†µä¸‹ä¹Ÿåªä¼šä¸¢å¤±ä¸è¶…è¿‡ä¸¤ç§’æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬è¾ƒç®€å•åªloadè‡ª å·±çš„AOFæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä»£ä»·ä¸€æ˜¯å¸¦æ¥äº†æŒç»­çš„IOï¼ŒäºŒæ˜¯AOF rewrite çš„æœ€åå°† rewrite è¿‡ç¨‹ä¸­äº§ ç”Ÿçš„æ–°æ•°æ®å†™åˆ°æ–°æ–‡ä»¶é€ æˆçš„é˜»å¡å‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚åªè¦ç¡¬ç›˜è®¸å¯ï¼Œåº”è¯¥å°½é‡å‡å°‘AOF rewrite çš„é¢‘ç‡ï¼ŒAOFé‡å†™çš„åŸºç¡€å¤§å°é»˜è®¤å€¼64Må¤ªå°äº†ï¼Œå¯ä»¥è®¾åˆ°5Gä»¥ä¸Šï¼Œé»˜è®¤è¶…è¿‡åŸå¤§å°100%å¤§å°é‡ å†™å¯ä»¥æ”¹åˆ°é€‚å½“çš„æ•°å€¼ã€‚<br>â€ƒâ€ƒå¦‚æœä¸Enable AOF ï¼Œä»…é  Master-Slave Repllcation å®ç°é«˜å¯ç”¨æ€§ä¹Ÿå¯ä»¥ï¼Œèƒ½çœæ‰ä¸€å¤§ç¬”IOï¼Œä¹Ÿ å‡å°‘äº†rewriteæ—¶å¸¦æ¥çš„ç³»ç»Ÿæ³¢åŠ¨ã€‚ä»£ä»·æ˜¯å¦‚æœMaster&#x2F;Slave åŒæ—¶å€’æ‰ï¼Œä¼šä¸¢å¤±åå‡ åˆ†é’Ÿçš„æ•°æ®ï¼Œ å¯åŠ¨è„šæœ¬ä¹Ÿè¦æ¯”è¾ƒä¸¤ä¸ª Master&#x2F;Slave ä¸­çš„ RDBæ–‡ä»¶ï¼Œè½½å…¥è¾ƒæ–°çš„é‚£ä¸ªï¼Œå¾®åšå°±æ˜¯è¿™ç§æ¶æ„ã€‚<br>14ã€Rediså‘å¸ƒè®¢é˜…<br>çº¿ç¨‹é€šä¿¡<br>â€ƒâ€ƒå¯¹åˆ— å­˜åœ¨ä¸¤ä¸ªä¸œè¥¿ï¼Œå‘é€è€… è®¢é˜…è€…</p>
<p>Redis å‘å¸ƒè®¢é˜…ï¼ˆpub&#x2F;subï¼‰ æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼<br>â€ƒâ€ƒ1.å‘é€è€…ï¼ˆpubï¼‰ å‘é€ä¿¡æ¯<br>â€ƒâ€ƒ2.è®¢é˜…è€…ï¼ˆsubï¼‰æ¥æ”¶ä¿¡æ¯ã€‚<br>â€ƒâ€ƒ3.å¾®ä¿¡ã€å¾®åšã€å…³æ³¨ç³»ç»Ÿ<br>â€ƒâ€ƒ4.æ¶ˆæ¯é˜Ÿåˆ—MQ</p>
<p>Redis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“<br>â€ƒâ€ƒç¬¬ä¸€ä¸ªï¼šæ¶ˆæ¯å‘é€è€…<br>â€ƒâ€ƒç¬¬äºŒä¸ªï¼šé¢‘é“<br>â€ƒâ€ƒç¬¬ä¸‰ä¸ªï¼šæ¶ˆæ¯è®¢é˜…è€…ï¼</p>
<p>é¢‘é“channel1ï¼Œä»¥åŠè®¢é˜…è¿™ä¸ªé¢‘é“çš„ä¸‰ä¸ªå®¢æˆ·ç«¯â€“client2ï¼Œclient5ï¼Œclient1ä¹‹é—´çš„å…³ç³»</p>
<p>å½“æœ‰æ–°æ¶ˆæ¯é€šè¿‡publish å‘½ä»¤å‘é€ç»™é¢‘é“channel1 æ—¶ï¼Œè¿™ä¸ªæ¶ˆæ¯å°±ä¼šè¢«å‘é€ç»™è®¢é˜…å®ƒçš„ä¸‰ä¸ªå®¢æˆ·ç«¯ï¼š</p>
<p>å‘½ä»¤</p>
<p>èœé¸Ÿæ•™ç¨‹ï¼š<a target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-pub-sub.html">https://www.runoob.com/redis/redis-pub-sub.html</a><br>1<br>æµ‹è¯•</p>
<p>è®¢é˜…ç«¯</p>
<p>127.0.0.1:6379&gt; subscribe xy #è®¢é˜…ä¸€ä¸ªé¢‘é“ xy<br>Reading messagesâ€¦ (press Ctrl-C to quit)</p>
<ol>
<li>â€œsubscribeâ€</li>
<li>â€œxyâ€</li>
<li>(integer) 1</li>
<li>â€œmessageâ€ # æ¶ˆæ¯</li>
<li>â€œxyâ€ # å“ªä¸ªé¢‘é“çš„æ¶ˆæ¯</li>
<li>â€œ123â€ # æ¶ˆæ¯çš„å†…å®¹</li>
<li>â€œmessageâ€</li>
<li>â€œxyâ€</li>
<li>â€œxyâ€</li>
<li>â€œmessageâ€</li>
<li>â€œxyâ€</li>
<li>â€œhelloredisâ€<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>å‘é€ç«¯</li>
</ol>
<p>127.0.0.1:6379&gt; publish xy 123 # å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯åˆ°é¢‘é“<br>(integer) 1<br>127.0.0.1:6379&gt; publish xy xy # å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯åˆ°é¢‘é“<br>(integer) 1<br>127.0.0.1:6379&gt; publish xy helloredis # å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯åˆ°é¢‘é“<br>(integer) 1<br>127.0.0.1:6379&gt;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>â€ƒâ€ƒRedisæ˜¯ä½¿ç”¨Cå®ç°çš„ï¼Œé€šè¿‡åˆ†æ Redis æºç é‡Œçš„ pubsub.c æ–‡ä»¶ï¼Œäº†è§£å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶çš„åº•å±‚å®ç°ï¼Œç± æ­¤åŠ æ·±å¯¹ Redis çš„ç†è§£ã€‚<br>Redis é€šè¿‡ PUBLISH ã€SUBSCRIBE å’Œ PSUBSCRIBE ç­‰å‘½ä»¤å®ç°å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½ã€‚<br>å¾®ä¿¡ï¼š<br>â€ƒâ€ƒé€šè¿‡ SUBSCRIBE å‘½ä»¤è®¢é˜…æŸé¢‘é“åï¼Œredis-server é‡Œç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®å°±æ˜¯ä¸€ä¸ªä¸ª é¢‘é“ï¼ï¼Œ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ª channel çš„å®¢æˆ·ç«¯ã€‚SUBSCRIBE å‘½ä»¤çš„å…³é”®ï¼Œ å°±æ˜¯å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°ç»™å®š channel çš„è®¢é˜…é“¾è¡¨ä¸­ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯<br>â€ƒâ€ƒå®æ—¶æ¶ˆæ¯ç³»ç»Ÿï¼<br>â€ƒâ€ƒäº‹å®èŠå¤©ï¼ï¼ˆé¢‘é“å½“åšèŠå¤©å®¤ï¼Œå°†ä¿¡æ¯å›æ˜¾ç»™æ‰€æœ‰äººï¼‰<br>â€ƒâ€ƒè®¢é˜…ã€å…³æ³¨ç³»ç»Ÿ</p>
<p>ç¨å¾®å¤æ‚çš„åœºæ™¯<br>â€ƒâ€ƒæ¶ˆæ¯ä¸­é—´é—´ MQ</p>
<p>15ã€Redisé›†ç¾¤<br>15.1Redisé›†ç¾¤â€“ä¸»ä»å¤åˆ¶<br>æ¯”å¦‚ï¼š1ä¸»äººâ€“2ä»†ä»<br>æ¦‚å¿µ<br>â€ƒâ€ƒä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°Redis æœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„Redis æœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹ï¼ˆMaster&#x2F;leaderï¼‰ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹ï¼ˆslave&#x2F;follwerï¼‰ï¼›æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Master ä»¥å†™ä¸ºä¸»ï¼ŒSlave ä»¥è¯»ä¸ºä¸»ã€‚</p>
<p>â€ƒâ€ƒé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°Redis æœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼›ä¸”ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä»èŠ‚ç‚¹ï¼ˆæˆ–è€…æ²¡æœ‰ä»èŠ‚ç‚¹ï¼‰ï¼Œä½†ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½ç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</p>
<p>ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š</p>
<p>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚<br>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚<br>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™ å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚<br>é«˜å¯ç”¨ï¼ˆé›†ç¾¤ï¼‰åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤ åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€ã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œè¦å°†Redisè¿ç”¨äºå·¥ç¨‹é¡¹ç›®ä¸­ï¼Œåªä½¿ç”¨ä¸€å°Redisæ˜¯ä¸‡ä¸‡ä¸èƒ½çš„ï¼ˆå®•æœºï¼Œ1ä¸»2ä»ï¼‰ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<p>â€ƒâ€ƒä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼Œå¹¶ä¸”ä¸€å°æœåŠ¡å™¨éœ€è¦å¤„ç†æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ï¼Œå‹åŠ›è¾ƒ å¤§ï¼›</p>
<p>â€ƒâ€ƒä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨å†…å­˜å®¹é‡æœ‰é™ï¼Œå°±ç®—ä¸€å°RedisæœåŠ¡å™¨å†…å­˜å®¹é‡ä¸º256Gï¼Œä¹Ÿä¸èƒ½å°†æ‰€æœ‰ å†…å­˜ç”¨ä½œRediså­˜å‚¨å†…å­˜ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå•å°Redisæœ€å¤§ä½¿ç”¨å†…å­˜ä¸åº”è¯¥è¶…è¿‡20Gã€‚ ç”µå•†ç½‘ç«™ä¸Šçš„å•†å“ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸€æ¬¡ä¸Šä¼ ï¼Œæ— æ•°æ¬¡æµè§ˆçš„ï¼Œè¯´ä¸“ä¸šç‚¹ä¹Ÿå°±æ˜¯â€å¤šè¯»å°‘å†™â€ã€‚</p>
<p>ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»ï¼80% çš„æƒ…å†µä¸‹éƒ½æ˜¯åœ¨è¿›ç¨‹è¯»æ“ä½œï¼å‡ç¼“æœåŠ¡å™¨çš„å‹åŠ›ï¼<br>æ¶æ„ä¸­ç»å¸¸ä½¿ç”¨ï¼ ä¸€ä¸» äºŒä»ï¼ï¼ˆæœ€ä½é…ï¼‰</p>
<p>åªè¦åœ¨å…¬å¸ä¸­ï¼Œä¸»ä»å¤åˆ¶å°±æ˜¯å¿…é¡»è¦ä½¿ç”¨çš„ï¼Œå› ä¸ºåœ¨çœŸå®çš„é¡¹ç›®ä¸­ä¸å¯èƒ½å•æœºä½¿ç”¨Redisï¼</p>
<p>ç¯å¢ƒé…ç½®</p>
<p>åªé…ä»åº“ï¼Œä¸é…ç½®ä¸»åº“ï¼</p>
<p>[root@localhost bin]# .&#x2F;redis-cli<br>127.0.0.1:6379&gt; info replication #æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯</p>
<h1 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h1><p>role:master #è§’è‰²ï¼šmaster<br>connected_slaves:0 #æ²¡æœ‰ä»æœº<br>master_replid:76cfb7376506413b4d6dd71f6da24afc8a61dedc<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:0<br>second_repl_offset:-1<br>repl_backlog_active:0<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:0<br>repl_backlog_histlen:0<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>ä¸»æœºï¼š6379</p>
<p>1ã€ç«¯å£<br>2ã€pid åå­—<br>3ã€logæ–‡ä»¶åå­—<br>4ã€dump.rdb åå­—<br>1<br>2<br>3<br>4</p>
<p>ä»æœºï¼š6380</p>
<p>ä»æœºï¼š6381</p>
<p>å¯åŠ¨</p>
<p>é»˜è®¤æƒ…å†µä¸‹ä¸‰å°éƒ½æ˜¯ä¸»æœº<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°Redis æœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼›ä¸€èˆ¬æƒ…å†µä¸‹åªç”¨é…ç½®ä»æœºå°±å¥½äº†è®¤è€å¤§ï¼</p>
<p>é…ç½®ä¸€ä¸»äºŒä»</p>
<p>å°†6379è¿™å°æœºå­è®¾ç½®ä¸ºä»æœº<br>å°±æ˜¯æ‰¾è°å½“è‡ªå·±çš„è€å¤§<br>slaveof</p>
<p>å°†6381è¿™å°æœºå­è®¾ç½®ä¸ºä»æœº</p>
<p>æŸ¥çœ‹ä¸»æœºçš„é…ç½®</p>
<p>çœŸå®çš„ä¸»ä»é…ç½®åº”è¯¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œè¿™æ ·çš„è¯æ˜¯æ°¸ä¹…çš„ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯å‘½ä»¤ï¼Œæš‚æ—¶çš„ï¼</p>
<p>ç»†èŠ‚<br>â€ƒâ€ƒ1.ä¸»æœºå¯ä»¥å†™ï¼Œä»æœºä¸èƒ½å†™åªèƒ½è¯»ï¼<br>â€ƒâ€ƒ2.ä¸»æœºä¸­çš„æ‰€æœ‰ä¿¡æ¯å’Œæ•°æ®ï¼Œéƒ½è‡ªåŠ¨è¢«ä»æœºä¿å­˜ï¼</p>
<p>ä»æœºåªèƒ½å†™</p>
<p>æµ‹è¯•ï¼šä¸»æœºæ–­å¼€è¿æ¥ï¼Œä»æœºä¾æ—§è¿æ¥åˆ°ä¸»æœºçš„ï¼Œä½†æ˜¯æ²¡æœ‰å†™æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸»æœºå¦‚æœå›æ¥äº†ï¼Œä»æœºä¾ æ—§å¯ä»¥ç›´æ¥è·å–åˆ°ä¸»æœºå†™çš„ä¿¡æ¯ï¼</p>
<p>å¦‚æœæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œï¼Œæ¥é…ç½®çš„ä¸»ä»ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœé‡å¯äº†ï¼Œå°±ä¼šå˜å›ä¸»æœºï¼åªè¦å˜ä¸ºä»æœºï¼Œç«‹é©¬å°±ä¼šä» ä¸»æœºä¸­è·å–å€¼ï¼</p>
<p>å¤åˆ¶åŸç†<br>Slave å¯åŠ¨æˆåŠŸè¿æ¥åˆ° master åä¼šå‘é€ä¸€ä¸ªsyncåŒæ­¥å‘½ä»¤</p>
<p>Master æ¥åˆ°å‘½ä»¤ï¼Œå¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œ å®Œæ¯•ä¹‹åï¼Œmasterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°slaveï¼Œå¹¶å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥ã€‚</p>
<p>å…¨é‡å¤åˆ¶ï¼šè€ŒslaveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p>
<p>å¢é‡å¤åˆ¶ï¼šMaster ç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ ç»™slaveï¼Œå®ŒæˆåŒæ­¥</p>
<p>ä½†æ˜¯åªè¦æ˜¯é‡æ–°è¿æ¥masterï¼Œä¸€æ¬¡å®Œå…¨åŒæ­¥ï¼ˆå…¨é‡å¤åˆ¶ï¼‰å°†è¢«è‡ªåŠ¨æ‰§è¡Œï¼ æˆ‘ä»¬çš„æ•°æ®ä¸€å®šå¯ä»¥åœ¨ä»æœºä¸­ çœ‹åˆ°ï¼</p>
<p>ç¬¬äºŒç§æ¨¡å‹ï¼šå±‚å±‚é“¾è·¯</p>
<p>â€ƒâ€ƒè¿™æ˜¯æ—¶å€™ä¹Ÿèƒ½å®Œæˆä¸»ä»å¤åˆ¶ï¼Œ6380 å³6379çš„ ä»èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯6381çš„ä¸»èŠ‚ç‚¹ï¼Œä½†æ˜¯è¯¥èŠ‚ç‚¹æ— æ³•å®Œæˆå†™å…¥çš„ã€‚</p>
<p>å¦‚æœæ²¡æœ‰è€å¤§äº†ï¼ˆä¸»èŠ‚ç‚¹æŒ‚äº†ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™èƒ½ä¸èƒ½é€‰æ‹©ä¸€ä¸ªè€å¤§å‡ºæ¥å‘¢ï¼Ÿå“¨å…µæ¨¡å¼æ²¡å‡ºæ¥ä¹‹å‰ï¼Œéƒ½æ˜¯éœ€è¦æ‰‹åŠ¨é…ç½®çš„</p>
<p>â€ƒâ€ƒè°‹æœç¯¡ä½</p>
<p>â€ƒâ€ƒå¦‚æœä¸»æœºæ–­å¼€äº†è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨ slaveof no one è®©è‡ªå·±å˜æˆä¸»æœºï¼å…¶ä»–çš„èŠ‚ç‚¹å°±å¯ä»¥æ‰‹åŠ¨è¿æ¥åˆ°æœ€æ–°çš„è¿™ä¸ªä¸»èŠ‚ç‚¹ï¼ˆæ‰‹åŠ¨ï¼‰</p>
<p>å¦‚æœè¿™ä¸ªæ—¶å€™è€å¤§ä¿®å¤äº†ï¼Œåªèƒ½é‡æ–°é…ç½®</p>
<p>â€ƒâ€ƒå¥½æ¯”è°‹æœç¯¡ä½ï¼Œçš‡å¸ä¸‹å°äº†ï¼Œä½ å†å›æ¥ä½ ä¹Ÿåšä¸äº†è€å¤§äº†</p>
<p>ä»¥ä¸‹6380 é‡æ–°è®¤6379ä¸ºè€å¤§</p>
<p>å“¨å…µæ¨¡å¼<br>ï¼ˆè‡ªåŠ¨é€‰ä¸¾è€å¤§ï¼‰</p>
<p>15.2Redisé›†ç¾¤â€“å“¨å…µæ¨¡å¼<br>æ¦‚å¿µï¼š<br>â€ƒâ€ƒä¸»ä»åˆ‡æ¢æŠ€æœ¯çš„æ–¹æ³•æ˜¯ï¼šå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°ä»æœåŠ¡å™¨åˆ‡æ¢ä¸ºä¸»æœåŠ¡å™¨ï¼Œè¿™å°±éœ€è¦äººå·¥ å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘ å“¨å…µæ¨¡å¼ã€‚Redisä»2.8å¼€å§‹æ­£å¼æä¾›äº†Sentinelï¼ˆå“¨å…µï¼‰ æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>â€ƒâ€ƒè°‹æœç¯¡ä½çš„è‡ªåŠ¨ç‰ˆï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œå¦‚æœæ•…éšœäº†æ ¹æ®æŠ•ç¥¨æ•°è‡ªåŠ¨å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“ã€‚</p>
<p>â€ƒâ€ƒå“¨å…µæ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ï¼Œé¦–å…ˆRedisæä¾›äº†å“¨å…µçš„å‘½ä»¤ï¼Œå“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ç«‹è¿è¡Œã€‚å…¶åŸç†æ˜¯å“¨å…µé€šè¿‡å‘é€å‘½ä»¤ï¼Œç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹ã€‚</p>
<p>è¿™é‡Œçš„å“¨å…µæœ‰ä¸¤ä¸ªä½œç”¨</p>
<p>é€šè¿‡å‘é€å‘½ä»¤ï¼Œè®©RedisæœåŠ¡å™¨è¿”å›ç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨ã€‚<br>å½“å“¨å…µç›‘æµ‹åˆ°masterå®•æœºï¼Œä¼šè‡ªåŠ¨å°†slaveåˆ‡æ¢æˆmasterï¼Œç„¶åé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä»–çš„ä»æœ åŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒä»¬åˆ‡æ¢ä¸»æœºã€‚<br>â€ƒâ€ƒç„¶è€Œä¸€ä¸ªå“¨å…µè¿›ç¨‹å¯¹RedisæœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚ å„ä¸ªå“¨å…µä¹‹é—´è¿˜ä¼šè¿›è¡Œç›‘æ§ï¼Œè¿™æ ·å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼ã€‚</p>
<p>â€ƒâ€ƒå‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œfailoverè¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤ ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡æˆä¸ºä¸»è§‚ä¸‹çº¿ã€‚å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€ å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œfailover[æ•…éšœè½¬ç§»]æ“ä½œã€‚ åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º å®¢è§‚ä¸‹çº¿ã€‚</p>
<p>æµ‹è¯•ï¼š<br>â€ƒâ€ƒé…ç½®ä¸€ä¸»äºŒä»ï¼</p>
<p>1.é…ç½®å“¨å…µé…ç½®æ–‡ä»¶<br>åŠ ç²—æ ·å¼åç§°ä¸èƒ½é”™ï¼Œsentinel.conf<br>monitor #è¢«ç›‘æ§çš„åç§°</p>
<p>127.0.0.1 #host<br>6379 #ç«¯å£å·port<br>1 #ä»£è¡¨ä¸»æœºæŒ‚äº†ï¼Œslave æŠ•ç¥¨çœ‹è®©è°æ¥æ›¿æˆä¸ºä¸»æœºï¼Œç¥¨æ•°æœ€å¤šçš„å°±ä¼šæˆä¸ºä¸»æœº<br>sentinel monitor myredis 127.0.0.1 6379 1<br>1<br>2<br>3<br>4</p>
<p>2.å¯åŠ¨å“¨å…µ</p>
<p>3.æµ‹è¯•ä¸»æœºè¹¦äº†<br>å…³é—­ä¸»æœº 6379</p>
<p>æŸ¥çœ‹6380<br>1<br>è‡ªåŠ¨è½¬ä¸ºä¸»æœº</p>
<p>æŸ¥çœ‹6381<br>è‡ªåŠ¨è®¤6380ä¸ºæ–°çš„è€å¤§</p>
<p>ç»“è®ºï¼š<br>â€ƒâ€ƒå¦‚æœmaster èŠ‚ç‚¹æ–­å¼€äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šä» ä»æœºä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨ï¼ˆè¿™é‡Œé¢æœ‰ä¸€ä¸ªæŠ•ç¥¨ç®—æ³•ï¼‰</p>
<p>â€ƒâ€ƒè¿™ä¸ªæ—¶å€™6379å†å›æ¥ä¹Ÿæ²¡æœ‰ç”¨äº†ï¼Œå®ƒæ˜¯ä¸ªå…‰æ†å¸ä»¤äº†ï¼Œå¦‚æœè¿˜æƒ³åšè€å¤§éœ€è¦æ‰‹åŠ¨é…ç½®ï¼<br>å¦‚æœ6379 å›æ¥äº†ï¼Œå®ƒä¹Ÿåªèƒ½åšä»æœºã€‚ï¼ˆä½ å›æ¥äº†ï¼Œåªèƒ½å½“æˆ‘çš„æ‰‹ä¸‹ï¼‰</p>
<p>â€ƒâ€ƒå¦‚æœä¸»æœºæ­¤æ—¶å›æ¥äº†ï¼Œåªèƒ½å½’å¹¶åˆ°æ–°çš„ä¸»æœºä¸‹ï¼Œå½“åšä»æœºï¼Œè¿™å°±æ˜¯å“¨å…µæ¨¡å¼çš„è§„åˆ™ï¼</p>
<p>å“¨å…µæ¨¡å¼ä¼˜ç‚¹ï¼š</p>
<p>å“¨å…µæ¨¡å¼é›†ç¾¤ï¼ŒåŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œæ‰€æœ‰çš„ä¸»ä»é…ç½®ä¼˜ç‚¹ï¼Œå®ƒå…¨æœ‰<br>ä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœå¯ä»¥è½¬ç§»ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§å°±ä¼šæ›´å¥½<br>å“¨å…µæ¨¡å¼å°±æ˜¯ä¸»ä»å¤åˆ¶çš„å‡çº§ï¼Œæ‰‹åŠ¨åˆ°è‡ªåŠ¨ï¼Œæ›´åŠ å¥å£®<br>å“¨å…µæ¨¡å¼ç¼ºç‚¹ï¼š</p>
<p>Redis ä¸å¥½åœ¨çº¿æ‰©å®¹ï¼Œé›†ç¾¤å®¹é‡ä¸€æ—¦åˆ°è¾¾ä¸Šé™ï¼Œåœ¨çº¿æ‰©å®¹å°±ååˆ†éº»çƒ¦ï¼<br>å®ç°å“¨å…µæ¨¡å¼çš„é…ç½®æ˜¯éå¸¸éº»çƒ¦çš„ï¼Œé‡Œé¢æœ‰å¾ˆå¤šé…ç½®<br>å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®</p>
<h1 id="Example-sentinel-conf"><a href="#Example-sentinel-conf" class="headerlink" title="Example sentinel.conf"></a>Example sentinel.conf</h1><h1 id="å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£-é»˜è®¤26379"><a href="#å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£-é»˜è®¤26379" class="headerlink" title="å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379"></a>å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379</h1><p>port 26379</p>
<h1 id="å“¨å…µsentinelçš„å·¥ä½œç›®å½•"><a href="#å“¨å…µsentinelçš„å·¥ä½œç›®å½•" class="headerlink" title="å“¨å…µsentinelçš„å·¥ä½œç›®å½•"></a>å“¨å…µsentinelçš„å·¥ä½œç›®å½•</h1><p>dir &#x2F;tmp</p>
<p>#å“¨å…µsentinelç›‘æ§çš„redisä¸»èŠ‚ç‚¹çš„ ip port</p>
<h1 id="master-name-å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­—-åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9-ã€"><a href="#master-name-å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­—-åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9-ã€" class="headerlink" title="master-name å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€"></a>master-name å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€</h1><p>è¿™ä¸‰ä¸ªå­—ç¬¦â€.-_â€ç»„æˆã€‚</p>
<h1 id="quorum-é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è”-é‚£ä¹ˆ"><a href="#quorum-é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è”-é‚£ä¹ˆ" class="headerlink" title="quorum é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆ"></a>quorum é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆ</h1><p>è¿™æ—¶å®¢è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹å¤±è”äº†<br>sentinel monitor mymaster 127.0.0.1 6379 2</p>
<h1 id="å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass-foobared-æˆæƒå¯†ç -è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„"><a href="#å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass-foobared-æˆæƒå¯†ç -è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„" class="headerlink" title="å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„"></a>å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„</h1><p>å®¢æˆ·ç«¯éƒ½è¦æä¾› å¯†ç </p>
<h1 id="è®¾ç½®å“¨å…µsentinel-è¿æ¥ä¸»ä»çš„å¯†ç -æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç "><a href="#è®¾ç½®å“¨å…µsentinel-è¿æ¥ä¸»ä»çš„å¯†ç -æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç " class="headerlink" title="è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç "></a>è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç </h1><p>sentinel auth-pass mymaster MySUPERâ€“secret-0123passw0rd</p>
<h1 id="æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å-ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel"><a href="#æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å-ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel" class="headerlink" title="æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel"></a>æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel</h1><p>æ­¤æ—¶ å“¨å…µä¸»è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿ é»˜è®¤30ç§’<br>sentinel down-after-milliseconds mymaster 30000</p>
<h1 id="è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„master"><a href="#è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„master" class="headerlink" title="è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„master"></a>è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„master</h1><p>è¿›è¡Œ åŒæ­¥ï¼Œ è¿™ä¸ªæ•°å­—è¶Šå°ï¼Œå®Œæˆfailoveræ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œ ä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œ<br>å°±æ„å‘³ç€è¶Š å¤šçš„slaveå› ä¸ºreplicationè€Œä¸å¯ç”¨ã€‚<br>å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªslave å¤„äºä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚<br>sentinel parallel-syncs mymaster 1</p>
<h1 id="æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´-failover-timeout-å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š"><a href="#æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´-failover-timeout-å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š" class="headerlink" title="æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š"></a>æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š</h1><p>#1. åŒä¸€ä¸ªsentinelå¯¹åŒä¸€ä¸ªmasterä¸¤æ¬¡failoverä¹‹é—´çš„é—´éš”æ—¶é—´ã€‚<br>#2. å½“ä¸€ä¸ªslaveä»ä¸€ä¸ªé”™è¯¯çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®å¼€å§‹è®¡ç®—æ—¶é—´ã€‚ç›´åˆ°slaveè¢«çº æ­£ä¸ºå‘<br>æ­£ç¡®çš„masteré‚£ é‡ŒåŒæ­¥æ•°æ®æ—¶ã€‚<br>#3.å½“æƒ³è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„failoveræ‰€éœ€è¦çš„æ—¶é—´ã€‚<br>#4.å½“è¿›è¡Œfailoveræ—¶ï¼Œé…ç½®æ‰€æœ‰slavesæŒ‡å‘æ–°çš„masteræ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚ä¸è¿‡ï¼Œå³ä½¿è¿‡äº†<br>è¿™ä¸ªè¶…æ—¶ï¼Œ slavesä¾ç„¶ä¼šè¢«æ­£ç¡®é…ç½®ä¸ºæŒ‡å‘masterï¼Œä½†æ˜¯å°±ä¸æŒ‰parallel-syncsæ‰€é…ç½®çš„<br>è§„åˆ™æ¥äº†</p>
<h1 id="é»˜è®¤ä¸‰åˆ†é’Ÿ"><a href="#é»˜è®¤ä¸‰åˆ†é’Ÿ" class="headerlink" title="é»˜è®¤ä¸‰åˆ†é’Ÿ"></a>é»˜è®¤ä¸‰åˆ†é’Ÿ</h1><p>sentinel failover-timeout mymaster 180000</p>
<h1 id="SCRIPTS-EXECUTION"><a href="#SCRIPTS-EXECUTION" class="headerlink" title="SCRIPTS EXECUTION"></a>SCRIPTS EXECUTION</h1><p>#é…ç½®å½“æŸä¸€äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æ¥é€šçŸ¥ç®¡ç†å‘˜ï¼Œ<br>ä¾‹å¦‚å½“ç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸æ—¶å‘é‚®ä»¶é€šçŸ¥ ç›¸å…³äººå‘˜ã€‚<br>#å¯¹äºè„šæœ¬çš„è¿è¡Œç»“æœæœ‰ä»¥ä¸‹è§„åˆ™ï¼š<br>#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›1ï¼Œé‚£ä¹ˆè¯¥è„šæœ¬ç¨åå°†ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œé‡å¤æ¬¡æ•°ç›®å‰é»˜è®¤ä¸º10<br>#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›2ï¼Œæˆ–è€…æ¯”2æ›´é«˜çš„ä¸€ä¸ªè¿”å›å€¼ï¼Œè„šæœ¬å°†ä¸ä¼šé‡å¤æ‰§è¡Œã€‚<br>#å¦‚æœè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºæ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·è¢«ç»ˆæ­¢äº†ï¼Œåˆ™åŒè¿”å›å€¼ä¸º1æ—¶çš„è¡Œä¸ºç›¸åŒã€‚<br>#ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º60sï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè„šæœ¬å°†ä¼šè¢«ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢ï¼Œä¹‹<br>åé‡æ–°æ‰§è¡Œã€‚</p>
<p>#é€šçŸ¥å‹è„šæœ¬:å½“sentinelæœ‰ä»»ä½•è­¦å‘Šçº§åˆ«çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯´rediså®ä¾‹çš„ä¸»è§‚å¤±æ•ˆå’Œå®¢è§‚<br>å¤±æ•ˆç­‰ç­‰ï¼‰ï¼Œ å°†ä¼šå»è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œè¿™æ—¶è¿™ä¸ªè„šæœ¬åº”è¯¥é€šè¿‡é‚®ä»¶ï¼ŒSMSç­‰æ–¹å¼å»é€šçŸ¥ç³»ç»Ÿç®¡ç†<br>å‘˜å…³äºç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„ä¿¡ æ¯ã€‚è°ƒç”¨è¯¥è„šæœ¬æ—¶ï¼Œå°†ä¼ ç»™è„šæœ¬ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„ç±»å‹ï¼Œ<br>ä¸€ä¸ªæ˜¯äº‹ä»¶çš„æè¿°ã€‚å¦‚æœsentinel.confé… ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿™ä¸ªè„šæœ¬è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»ä¿è¯è¿™<br>ä¸ªè„šæœ¬å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ï¼Œå¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¦åˆ™sentinelæ—  æ³•æ­£å¸¸å¯åŠ¨æˆåŠŸã€‚<br>#é€šçŸ¥è„šæœ¬</p>
<h1 id="shellç¼–ç¨‹"><a href="#shellç¼–ç¨‹" class="headerlink" title="shellç¼–ç¨‹"></a>shellç¼–ç¨‹</h1><p>sentinel notification-script mymaster &#x2F;var&#x2F;redis&#x2F;notify.sh</p>
<h1 id="å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬"><a href="#å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬" class="headerlink" title="å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬"></a>å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬</h1><h1 id="å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯"><a href="#å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯" class="headerlink" title="å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯"></a>å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯</h1><p>å…³äºmasteråœ°å€å·² ç»å‘ç”Ÿæ”¹å˜çš„ä¿¡æ¯ã€‚</p>
<h1 id="ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬"><a href="#ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬" class="headerlink" title="ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:"></a>ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:</h1><h1 id="ç›®å‰æ€»æ˜¯â€œfailoverâ€"><a href="#ç›®å‰æ€»æ˜¯â€œfailoverâ€" class="headerlink" title="# ç›®å‰æ€»æ˜¯â€œfailoverâ€,"></a># ç›®å‰æ€»æ˜¯â€œfailoverâ€,</h1><h1 id="æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚"><a href="#æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚" class="headerlink" title="æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚"></a>æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚</h1><h1 id="å‚æ•°-from-ip-from-port-to-ip-to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master-å³æ—§"><a href="#å‚æ•°-from-ip-from-port-to-ip-to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master-å³æ—§" class="headerlink" title="å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§"></a>å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§</h1><p>çš„slave)é€š ä¿¡çš„</p>
<h1 id="è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚"><a href="#è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚" class="headerlink" title="è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚"></a>è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚</h1><p>sentinel client-reconfig-script mymaster &#x2F;var&#x2F;redis&#x2F;reconfig.sh</p>
<h1 id="ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼"><a href="#ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼" class="headerlink" title="ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼"></a>ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼</h1><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br>67<br>68<br>69<br>70<br>71<br>72<br>73<br>74<br>75<br>76<br>77<br>78<br>79<br>80<br>81<br>ç¤¾ä¼šç›®å‰ç¨‹åºå‘˜é¥±å’Œï¼ˆåˆçº§å’Œä¸­çº§ï¼‰ã€é«˜çº§ç¨‹åºå‘˜æ˜¯é‡é‡‘éš¾æ±‚çš„ï¼æå‡è‡ªå·±</p>
<p>16ã€Redisç¼“å­˜ç©¿é€å’Œé›ªå´©<br>â€ƒâ€ƒRedisç¼“å­˜çš„ä½¿ç”¨ï¼Œæå¤§çš„æå‡äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯æ•°æ®æŸ¥è¯¢æ–¹é¢ã€‚ä½†åŒæ—¶ï¼Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€ äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œæœ€è¦å®³çš„é—®é¢˜ï¼Œå°±æ˜¯æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œè¿™ä¸ªé—®é¢˜æ— è§£ã€‚å¦‚æœå¯¹æ•°æ® çš„ä¸€è‡´æ€§è¦æ±‚å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨ç¼“å­˜ã€‚<br>â€ƒâ€ƒå¦å¤–çš„ä¸€äº›å…¸å‹é—®é¢˜å°±æ˜¯ï¼Œç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿ã€‚ç›®å‰ï¼Œä¸šç•Œä¹Ÿéƒ½æœ‰æ¯”è¾ƒæµè¡Œçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ç¼“å­˜ç©¿é€</p>
<p>æ¦‚å¿µ<br>â€ƒâ€ƒç¼“å­˜ç©¿é€çš„æ¦‚å¿µå¾ˆç®€å•ï¼Œç”¨æˆ·æƒ³è¦æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œäº æ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ã€‚å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æœ¬æ¬¡æŸ¥è¯¢å¤±è´¥ã€‚å½“ç”¨æˆ·å¾ˆå¤šçš„æ—¶å€™ï¼Œç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­ï¼ˆç§’ æ€ï¼ï¼‰ï¼Œäºæ˜¯éƒ½å»è¯·æ±‚äº†æŒä¹…å±‚æ•°æ®åº“ã€‚è¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œè¿™æ—¶å€™å°±ç›¸å½“äºå‡ºç°äº† ç¼“å­˜ç©¿é€ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆ</p>
<p>å¸ƒéš†è¿‡æ»¤å™¨<br>â€ƒâ€ƒå¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ ä¸¢å¼ƒï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ï¼›</p>
<p>ç¼“å­˜ç©ºå¯¹è±¡<br>â€ƒâ€ƒå½“å­˜å‚¨å±‚ä¸å‘½ä¸­åï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•° æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤äº†åç«¯æ•°æ®æºï¼›</p>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š<br>â€ƒâ€ƒ1ã€å¦‚æœç©ºå€¼èƒ½å¤Ÿè¢«ç¼“å­˜èµ·æ¥ï¼Œè¿™å°±æ„å‘³ç€ç¼“å­˜éœ€è¦æ›´å¤šçš„ç©ºé—´å­˜å‚¨æ›´å¤šçš„é”®ï¼Œå› ä¸ºè¿™å½“ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤š çš„ç©ºå€¼çš„é”®ï¼›</p>
<p>â€ƒâ€ƒ2ã€å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äº éœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ã€‚</p>
<p>ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰<br>â€ƒâ€ƒè¿™é‡Œéœ€è¦æ³¨æ„å’Œç¼“å­˜å‡»ç©¿çš„åŒºåˆ«ï¼Œç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­ å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚<br>â€ƒâ€ƒå½“æŸä¸ªkeyåœ¨è¿‡æœŸçš„ç¬é—´ï¼Œæœ‰å¤§é‡çš„è¯·æ±‚å¹¶å‘è®¿é—®ï¼Œè¿™ç±»æ•°æ®ä¸€èˆ¬æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œç”±äºç¼“å­˜è¿‡æœŸï¼Œä¼šåŒæ—¶è®¿ é—®æ•°æ®åº“æ¥æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”å›å†™ç¼“å­˜ï¼Œä¼šå¯¼ä½¿æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚</p>
<p>1.è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ<br>â€ƒâ€ƒä»ç¼“å­˜å±‚é¢æ¥çœ‹ï¼Œæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°çƒ­ç‚¹ key è¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜ã€‚</p>
<p>2.åŠ äº’æ–¥é”<br>â€ƒâ€ƒåˆ†å¸ƒå¼é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œä¿è¯å¯¹äºæ¯ä¸ªkeyåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢åç«¯æœåŠ¡ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰è·å¾—åˆ†å¸ƒ å¼é”çš„æƒé™ï¼Œå› æ­¤åªéœ€è¦ç­‰å¾…å³å¯ã€‚è¿™ç§æ–¹å¼å°†é«˜å¹¶å‘çš„å‹åŠ›è½¬ç§»åˆ°äº†åˆ†å¸ƒå¼é”ï¼Œå› æ­¤å¯¹åˆ†å¸ƒå¼é”çš„è€ƒ éªŒå¾ˆå¤§ã€‚</p>
<p>ç¼“å­˜é›ªå´©<br>â€ƒâ€ƒç¼“å­˜é›ªå´©ï¼Œæ˜¯æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆã€‚Redis å®•æœºï¼</p>
<p>â€ƒâ€ƒäº§ç”Ÿé›ªå´©çš„åŸå› ä¹‹ä¸€ï¼Œæ¯”å¦‚åœ¨å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±è¦åˆ°åŒåäºŒé›¶ç‚¹ï¼Œå¾ˆå¿«å°±ä¼šè¿æ¥ä¸€æ³¢æŠ¢è´­ï¼Œè¿™æ³¢å•† å“æ—¶é—´æ¯”è¾ƒé›†ä¸­çš„æ”¾å…¥äº†ç¼“å­˜ï¼Œå‡è®¾ç¼“å­˜ä¸€ä¸ªå°æ—¶ã€‚é‚£ä¹ˆåˆ°äº†å‡Œæ™¨ä¸€ç‚¹é’Ÿçš„æ—¶å€™ï¼Œè¿™æ‰¹å•†å“çš„ç¼“å­˜å°±éƒ½è¿‡æœŸäº†ã€‚è€Œå¯¹è¿™æ‰¹å•†å“çš„è®¿é—®æŸ¥è¯¢ï¼Œéƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹äºæ•°æ®åº“è€Œè¨€ï¼Œå°±ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢å³°ã€‚äºæ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¾¾åˆ°å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šæŒ‚æ‰çš„æƒ…å†µã€‚</p>
<p>â€ƒâ€ƒå…¶å®é›†ä¸­è¿‡æœŸï¼Œå€’ä¸æ˜¯éå¸¸è‡´å‘½ï¼Œæ¯”è¾ƒè‡´å‘½çš„ç¼“å­˜é›ªå´©ï¼Œæ˜¯ç¼“å­˜æœåŠ¡å™¨æŸä¸ªèŠ‚ç‚¹å®•æœºæˆ–æ–­ç½‘ã€‚å› ä¸ºè‡ªç„¶ å½¢æˆçš„ç¼“å­˜é›ªå´©ï¼Œä¸€å®šæ˜¯åœ¨æŸä¸ªæ—¶é—´æ®µé›†ä¸­åˆ›å»ºç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ•°æ®åº“ä¹Ÿæ˜¯å¯ä»¥é¡¶ä½å‹åŠ›çš„ã€‚æ— éå°± æ˜¯å¯¹æ•°æ®åº“äº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›è€Œå·²ã€‚è€Œç¼“å­˜æœåŠ¡èŠ‚ç‚¹çš„å®•æœºï¼Œå¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆçš„å‹åŠ›æ˜¯ä¸å¯é¢„çŸ¥ çš„ï¼Œå¾ˆæœ‰å¯èƒ½ç¬é—´å°±æŠŠæ•°æ®åº“å‹å®ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆ</p>
<p>1.redisé«˜å¯ç”¨<br>â€ƒâ€ƒè¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­ å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤ã€‚ï¼ˆå¼‚åœ°å¤šæ´»ï¼ï¼‰</p>
<p>2.é™æµé™çº§ï¼ˆåœ¨SpringCloudè®²è§£è¿‡ï¼ï¼‰<br>â€ƒâ€ƒè¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹ æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</p>
<p>3.æ•°æ®é¢„çƒ­<br>â€ƒâ€ƒæ•°æ®åŠ çƒ­çš„å«ä¹‰å°±æ˜¯åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½çš„æ•°æ®å…ˆé¢„å…ˆè®¿é—®ä¸€éï¼Œè¿™æ ·éƒ¨åˆ†å¯èƒ½å¤§é‡è®¿é—®çš„æ•° æ®å°±ä¼šåŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®© ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</p>
<p>åŒåä¸€ï¼šåœæ‰ä¸€äº›æœåŠ¡ï¼Œï¼ˆä¿è¯ä¸»è¦çš„æœåŠ¡å¯ç”¨ï¼‰</p>
<p>æ€»ç»“<br>äº”å¤§æ•°æ®ç±»å‹<br>javaæ“ä½œjedis<br>æŒä¹…åŒ–<br>ä¸»ä»å¤åˆ¶<br>ç¼“å­˜é›ªå´©å’Œç¼“å­˜ç©¿é€</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Java/" class="category-chain-item">Java</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Java/">#Java</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Redis</div>
      <div>https://lfrok.top/2022/11/27/Java/Redis/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>B612ğŸš€</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´11æœˆ27æ—¥</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/11/27/Java/SpringMVC/" title="SpringMVC">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SpringMVC</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/11/27/schedule/2022-12-1/" title="2022-12-1">
                        <span class="hidden-mobile">2022-12-1</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA==">
    <script type="text/javascript">
      Fluid.utils.loadComments('#lv-container', function() {
        Fluid.utils.createScript('https://cdn-city.livere.com/js/embed.dist.js');
      });
    </script>
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Fork</span></a> <strong><i style= color:red>â˜­ </i></strong> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>B-612</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
